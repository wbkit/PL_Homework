<!DOCTYPE html>
<!-- saved from url=(0117)https://danieltakeshi.github.io/2017/03/28/going-deeper-into-reinforcement-learning-fundamentals-of-policy-gradients/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Going Deeper Into Reinforcement Learning: Fundamentals of Policy Gradients</title>
  <meta name="description" content="As I stated in my last blog post, I am feverishly trying to read moreresearch papers. One category of papers that seems to be coming up a lotrecently are tho...">

  <link rel="stylesheet" href="./Going Deeper Into Reinforcement Learning_ Fundamentals of Policy Gradients_files/main.css">
  <link rel="canonical" href="https://danieltakeshi.github.io/2017/03/28/going-deeper-into-reinforcement-learning-fundamentals-of-policy-gradients/">
  <link rel="alternate" type="application/rss+xml" title="Seita&#39;s Place" href="https://danieltakeshi.github.io/feed.xml">

  <script async="" src="./Going Deeper Into Reinforcement Learning_ Fundamentals of Policy Gradients_files/analytics.js"></script><script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      extensions: ["tex2jax.js"],
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
      },
      messageStyle: "none",
      "HTML-CSS": { availableFonts: ["TeX"] }
    });
  </script>
  <script src="./Going Deeper Into Reinforcement Learning_ Fundamentals of Policy Gradients_files/MathJax.js" id="">
  </script>

<script type="text/javascript" async="" src="./Going Deeper Into Reinforcement Learning_ Fundamentals of Policy Gradients_files/embed.js"></script><link rel="prefetch" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.7ab903feba7624935283ca4c7d8c7203.css"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.2f2f40d40785c9541a90e9086c8770a3.js"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.920cdf639b386b42eddc25a8b2755561.js"><link rel="prefetch" as="script" href="https://disqus.com/next/config.js"><script async="" id="dsq_recs_scr" src="./Going Deeper Into Reinforcement Learning_ Fundamentals of Policy Gradients_files/recommendations.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><link rel="prefetch" as="style" href="https://c.disquscdn.com/next/recommendations/styles/recommendations.10022a97346f1c6e3798931bbd8e4bb5.css"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/recommendations/common.bundle.6c6defcc206edabe5048d82459ee0a0e.js"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/recommendations/recommendations.bundle.926bc472e4859a48daa346b4ba2ab4f4.js"><link rel="prefetch" as="script" href="https://disqus.com/next/config.js"><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style></head>


  <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="https://danieltakeshi.github.io/">Seita's Place</a>

    <nav class="site-nav">
      <a href="https://danieltakeshi.github.io/2017/03/28/going-deeper-into-reinforcement-learning-fundamentals-of-policy-gradients/#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="https://danieltakeshi.github.io/about.html">About</a>
          
        
          
          <a class="page-link" href="https://danieltakeshi.github.io/archive.html">Archive</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="https://danieltakeshi.github.io/new-start-here.html">New? Start Here</a>
          
        
          
          <a class="page-link" href="https://danieltakeshi.github.io/subscribe.html">Subscribe</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Going Deeper Into Reinforcement Learning: Fundamentals of Policy Gradients</h1>
    <p class="post-meta">Mar 27, 2017</p>
  </header>

  <article class="post-content">
    <p>As I stated <a href="https://danieltakeshi.github.io/2017/03/23/keeping-track-of-research-articles-my-paper-notes-repository/">in my last blog post</a>, I am feverishly trying to read more
research papers. One category of papers that seems to be coming up a lot
recently are those about <em>policy gradients</em>, which are a popular class of
reinforcement learning algorithms which estimate a gradient for a function
approximator. Thus, the purpose of this blog post is for me to explicitly write
the mathematical foundations for policy gradients so that I can gain
understanding. In turn, I hope some of my explanations will be useful to a
broader audience of AI students.</p>

<h1 id="assumptions-and-problem-statement">Assumptions and Problem Statement</h1>

<p>In any type of research domain, we always have to make some set of assumptions.
(By “we”, I refer to the researchers who write papers on this.) With
reinforcement learning and policy gradients, the assumptions usually mean the
<strong>episodic</strong> setting where an agent engages in multiple <strong>trajectories</strong> in its
environment. As an example, an agent could be playing a game of Pong, so one
episode or trajectory consists of a full start-to-finish game.</p>

<p>We define a trajectory <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1000.57em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">\tau</script> of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.67em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">T</script> as</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 25.106em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.715em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1020.61em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main; padding-left: 0.261em;">(</span><span class="msubsup" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-14" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-16" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-20" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-22" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-24" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-26" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-28" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-30" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-32" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main; padding-left: 0.158em;">…</span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main; padding-left: 0.158em;">,</span><span class="msubsup" id="MathJax-Span-38" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-40"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-46" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-48"><span class="mrow" id="MathJax-Span-49"><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-51" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-52" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-54" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-56"><span class="mrow" id="MathJax-Span-57"><span class="mi" id="MathJax-Span-58" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-59" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-60" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-62" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-65" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>τ</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><msub><mi>r</mi><mn>0</mn></msub><mo>,</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>s</mi><mi>T</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">\tau = (s_0, a_0, r_0, s_1, a_1, r_1, \ldots, s_{T-1}, a_{T-1}, r_{T-1}, s_T)</script>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-66" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.88em, 2.43em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-67"><span class="msubsup" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-70" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">s_0</script> comes from the starting distribution of states, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-71" style="width: 7.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.788em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1005.68em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-72"><span class="msubsup" id="MathJax-Span-73"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-75" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main; padding-left: 0.261em;">∼</span><span class="msubsup" id="MathJax-Span-77" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-79" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-81"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-83" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-84"><span class="mrow" id="MathJax-Span-85"><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-87"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-89" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">a_i \sim
\pi_\theta(a_i| s_i)</script>, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-91" style="width: 10.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.577em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1008.47em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="msubsup" id="MathJax-Span-93"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-95" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main; padding-left: 0.261em;">∼</span><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic; padding-left: 0.261em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-99"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-101" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-102"><span class="mrow" id="MathJax-Span-103"><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-105"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="mi" id="MathJax-Span-109" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-111" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-113" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-115"><span class="mrow" id="MathJax-Span-116"><span class="mi" id="MathJax-Span-117" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-118" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>i</mi></msub><mo>∼</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">s_i \sim P(s_i | s_{i-1},a_{i-1})</script> with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-121" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.73em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">P</script> the
dynamics model (i.e. how the environment changes). We actually <em>ignore</em> the
dynamics when optimizing, since all we care about is getting a good gradient
signal for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-124" style="width: 1.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1000.98em, 2.43em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-125"><span class="msubsup" id="MathJax-Span-126"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-128" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-8">\pi_\theta</script> to make it better. If this isn’t clear now, it will be
clear soon. Also, the reward can be computed from the states and actions, since
it’s usually a function of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-129" style="width: 5.994em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.961em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1004.86em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-130"><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-132"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-136" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-140" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-142"><span class="mrow" id="MathJax-Span-143"><span class="mi" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">(s_i,a_i,s_{i+1})</script>, so it’s not technically needed
in the trajectory.</p>

<p>What’s our <em>goal</em> here with policy gradients? Unlike algorithms such as DQN,
which strive to find an excellent policy indirectly through Q-values, policy
gradients perform a <em>direct</em> gradient update on a policy to change its
parameters, which is what makes it so appealing.  Formally, we have:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;z&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-148" style="width: 13.226em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.901em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(2.069em, 1010.64em, 5.374em, -999.997em); top: -3.975em; left: 0em;"><span class="mrow" id="MathJax-Span-149"><span class="msubsup" id="MathJax-Span-150"><span style="display: inline-block; position: relative; width: 4.548em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1004.13em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-151"><span class="mrow" id="MathJax-Span-152"><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Main;">x</span><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Main;">z</span><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Main;">e</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 4.135em;"><span class="texatom" id="MathJax-Span-161"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mspace" id="MathJax-Span-164" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-165"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-166"><span class="mrow" id="MathJax-Span-167"><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="msubsup" id="MathJax-Span-171"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="texatom" id="MathJax-Span-173"><span class="mrow" id="MathJax-Span-174"><span class="mi" id="MathJax-Span-175" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-176" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-177" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-178"><span class="munderover" id="MathJax-Span-179"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-181"><span class="mrow" id="MathJax-Span-182"><span class="mi" id="MathJax-Span-183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-184" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-186"><span class="mrow" id="MathJax-Span-187"><span class="mi" id="MathJax-Span-188" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-191" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.622em;"><span class="mi" id="MathJax-Span-193" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-194"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-196" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-197" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">z</mi><mi mathvariant="normal">e</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub><mspace width="thickmathspace"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msup><mi>γ</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">{\rm maximize}_{\theta}\; \mathbb{E}_{\pi_{\theta}}\left[\sum_{t=0}^{T-1}\gamma^t r_t\right]</script>

<ul>
  <li>
    <p><strong>Note I</strong>: I put <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-198" style="width: 1.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1000.98em, 2.43em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-199"><span class="msubsup" id="MathJax-Span-200"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-201" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-202"><span class="mrow" id="MathJax-Span-203"><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-11">\pi_{\theta}</script> under the expectation. This means the
rewards are computed from a trajectory which was generated under the policy
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-205" style="width: 1.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1000.98em, 2.43em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-206"><span class="msubsup" id="MathJax-Span-207"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-209" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-12">\pi_\theta</script>. We have to <em>find</em> “optimal” settings of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-210" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1000.47em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math-italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">\theta</script> to make
this work.</p>
  </li>
  <li>
    <p><strong>Note II</strong>: we don’t need to optimize the expected sum of discounted rewards,
though it’s the formulation I’m most used to. Alternatives include ignoring
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-213" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.52em, 2.482em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-214"><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">\gamma</script> by setting it to one, extending <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-216" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.67em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-217"><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">T</script> to infinity if the episodes
are infinite-horizon, and so on.</p>
  </li>
</ul>

<p>The above raises the all-important question: <em>how do we find the best
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-219" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1000.47em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-220"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math-italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">\theta</script></em>? If you’ve taken optimization classes before, you should know the
answer already: perform gradient ascent on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-222" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1000.47em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-223"><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math-italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">\theta</script>, so we have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-225" style="width: 8.525em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.027em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1006.92em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-226"><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main; padding-left: 0.261em;">←</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math-italic; padding-left: 0.261em;">θ</span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic; padding-left: 0.209em;">α</span><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Main;">∇</span><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo stretchy="false">←</mo><mi>θ</mi><mo>+</mo><mi>α</mi><mi mathvariant="normal">∇</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">\theta
\leftarrow \theta + \alpha \nabla f(x)</script> where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-237" style="width: 2.327em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.81em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-238"><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19">f(x)</script> is the function being
optimized.  Here, that’s the expected value of whatever sum of rewards formula
we’re using.</p>

<h1 id="two-steps-log-derivative-trick-and-determining-log-probability">Two Steps: Log-Derivative Trick and Determining Log Probability</h1>

<p>Before getting to the computation of the gradient, let’s first review two
mathematical facts which will be used later, and which are also of independent interest.
The first is the “log-derivative” trick, which tells us how to insert a log into
an expectation when starting from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-243" style="width: 5.271em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.341em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1004.24em, 2.843em, -999.997em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-244"><span class="msubsup" id="MathJax-Span-245"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-247" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-251" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.43em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-20">\nabla_\theta \mathbb{E}[f(x)]</script>.
Specifically, we have:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-257" style="width: 21.077em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.41em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-3.097em, 1017.2em, 6.821em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-258"><span class="mtable" id="MathJax-Span-259" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 17.1em; height: 0px;"><span style="position: absolute; clip: rect(4.703em, 1004.24em, 13.329em, -999.997em); top: -9.295em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.341em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1004.24em, 4.393em, -999.997em); top: -7.642em; right: 0em;"><span class="mtd" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="msubsup" id="MathJax-Span-262"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-264" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-265"><span class="mrow" id="MathJax-Span-266"><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -5.008em; right: 0em;"><span class="mtd" id="MathJax-Span-294"><span class="mrow" id="MathJax-Span-295"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -2.373em; right: 0em;"><span class="mtd" id="MathJax-Span-331"><span class="mrow" id="MathJax-Span-332"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -0.101em; right: 0em;"><span class="mtd" id="MathJax-Span-361"><span class="mrow" id="MathJax-Span-362"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.3em;"></span></span><span style="position: absolute; clip: rect(5.374em, 1012.71em, 15.292em, -999.997em); top: -10.586em; left: 4.341em;"><span style="display: inline-block; position: relative; width: 12.761em; height: 0px;"><span style="position: absolute; clip: rect(2.482em, 1008.99em, 5.013em, -999.997em); top: -7.642em; left: 0em;"><span class="mtd" id="MathJax-Span-274"><span class="mrow" id="MathJax-Span-275"><span class="mi" id="MathJax-Span-276"></span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-278" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-280" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Size2; vertical-align: 0.003em; padding-left: 0.158em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.416em;"></span></span><span class="msubsup" id="MathJax-Span-282" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-289" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.379em, 1011.47em, 5.116em, -999.997em); top: -5.008em; left: 0em;"><span class="mtd" id="MathJax-Span-296"><span class="mrow" id="MathJax-Span-297"><span class="mi" id="MathJax-Span-298"></span><span class="mo" id="MathJax-Span-299" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Size2; vertical-align: 0.003em; padding-left: 0.261em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.416em;"></span></span><span class="mfrac" id="MathJax-Span-301" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 2.379em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.05em, 1002.17em, 4.393em, -999.997em); top: -4.698em; left: 50%; margin-left: -1.134em;"><span class="mrow" id="MathJax-Span-302"><span class="msubsup" id="MathJax-Span-303"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1002.17em, 4.393em, -999.997em); top: -3.252em; left: 50%; margin-left: -1.134em;"><span class="mrow" id="MathJax-Span-309"><span class="msubsup" id="MathJax-Span-310"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-312" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1002.38em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.379em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-316"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-317" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-318" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-319"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-321" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-326" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.482em, 1012.71em, 5.013em, -999.997em); top: -2.373em; left: 0em;"><span class="mtd" id="MathJax-Span-333"><span class="mrow" id="MathJax-Span-334"><span class="mi" id="MathJax-Span-335"></span><span class="mo" id="MathJax-Span-336" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Size2; vertical-align: 0.003em; padding-left: 0.261em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.416em;"></span></span><span class="msubsup" id="MathJax-Span-338" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-340" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-341" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-344"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-346" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-348"></span><span class="msubsup" id="MathJax-Span-349" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-351" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-354" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-355" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-356" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-358" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.689em, 1009.66em, 4.806em, -999.997em); top: -0.101em; left: 0em;"><span class="mtd" id="MathJax-Span-363"><span class="mrow" id="MathJax-Span-364"><span class="mi" id="MathJax-Span-365"></span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="texatom" id="MathJax-Span-367" style="padding-left: 0.261em;"><span class="mrow" id="MathJax-Span-368"><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_AMS;">E</span></span></span><span class="texatom" id="MathJax-Span-370"><span class="mrow" id="MathJax-Span-371"><span class="mo" id="MathJax-Span-372" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="mi" id="MathJax-Span-373" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-374" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-377"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-379" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-380" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-381"></span><span class="msubsup" id="MathJax-Span-382" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-383" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-385" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-386" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-388"><span class="mrow" id="MathJax-Span-389"><span class="mo" id="MathJax-Span-390" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.591em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.559em; border-left: 0px solid; width: 0px; height: 11.691em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mo>∫</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mo>∫</mo><mfrac><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mo>∫</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-21">\begin{align}
\nabla_\theta \mathbb{E}[f(x)] &= \nabla_\theta \int p_\theta(x)f(x)dx \\
&= \int \frac{p_\theta(x)}{p_\theta(x)} \nabla_\theta p_\theta(x)f(x)dx \\
&= \int p_\theta(x)\nabla_\theta \log p_\theta(x)f(x)dx \\
&= \mathbb{E}\Big[f(x)\nabla_\theta \log p_\theta(x)\Big]
\end{align}</script>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-391" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.93em, 2.482em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-392"><span class="msubsup" id="MathJax-Span-393"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-395" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-22">p_\theta</script> is the density of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-396" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.52em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-397"><span class="mi" id="MathJax-Span-398" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">x</script>. Most of these steps should be
straightforward. The main technical detail to worry about is exchanging the
gradient with the integral. I have never been comfortable in knowing when we are
allowed to do this or not, but since everyone else does this, I will follow
them.</p>

<p>Another technical detail we will need is the gradient of the log probability of
a <em>trajectory</em> since we will later switch <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-399" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.52em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-400"><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">x</script> from above with a trajectory
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-402" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1000.57em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-403"><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">\tau</script>. The computation of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-405" style="width: 4.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.67em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1003.57em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-406"><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-408"></span><span class="msubsup" id="MathJax-Span-409" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-410" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-411" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-414" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">\log p_\theta(\tau)</script> proceeds as follows:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-415" style="width: 35.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.703em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-3.045em, 1029.29em, 6.769em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-416"><span class="mtable" id="MathJax-Span-417" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 29.393em; height: 0px;"><span style="position: absolute; clip: rect(4.135em, 1004.96em, 11.779em, -999.997em); top: -8.314em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.065em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1004.96em, 4.393em, -999.997em); top: -7.229em; right: 0em;"><span class="mtd" id="MathJax-Span-418"><span class="mrow" id="MathJax-Span-419"><span class="msubsup" id="MathJax-Span-420"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-422" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-423" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-424"></span><span class="msubsup" id="MathJax-Span-425" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-427" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -3.923em; right: 0em;"><span class="mtd" id="MathJax-Span-494"><span class="mrow" id="MathJax-Span-495"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -0.669em; right: 0em;"><span class="mtd" id="MathJax-Span-569"><span class="mrow" id="MathJax-Span-570"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.319em;"></span></span><span style="position: absolute; clip: rect(5.374em, 1024.07em, 15.189em, -999.997em); top: -10.535em; left: 5.065em;"><span style="display: inline-block; position: relative; width: 24.383em; height: 0px;"><span style="position: absolute; clip: rect(2.069em, 1018.18em, 5.374em, -999.997em); top: -7.229em; left: 0em;"><span class="mtd" id="MathJax-Span-431"><span class="mrow" id="MathJax-Span-432"><span class="mi" id="MathJax-Span-433"></span><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Main; padding-left: 0.261em;">∇</span><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-437"></span><span class="mrow" id="MathJax-Span-438"><span class="mo" id="MathJax-Span-439" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math-italic;">μ</span><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-443"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-444" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-445" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-446" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-447" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.24em, 4.6em, -999.997em); top: -3.975em; left: 0.054em;"><span class="mo" id="MathJax-Span-448" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.106em;"><span class="texatom" id="MathJax-Span-449"><span class="mrow" id="MathJax-Span-450"><span class="mi" id="MathJax-Span-451" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-452" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-453" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0em;"><span class="texatom" id="MathJax-Span-454"><span class="mrow" id="MathJax-Span-455"><span class="mi" id="MathJax-Span-456" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-457" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-458" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-459" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-461" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-462" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-463"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-464" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-465" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-466"><span class="mrow" id="MathJax-Span-467"><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-470" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-471" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-472" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-475"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-477"><span class="mrow" id="MathJax-Span-478"><span class="mi" id="MathJax-Span-479" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-480" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-481" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-482"><span class="mrow" id="MathJax-Span-483"><span class="mo" id="MathJax-Span-484" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-485"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-486" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-487" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-488" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-489" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-491" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-493" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.069em, 1024.07em, 5.374em, -999.997em); top: -3.923em; left: 0em;"><span class="mtd" id="MathJax-Span-496"><span class="mrow" id="MathJax-Span-497"><span class="mi" id="MathJax-Span-498"></span><span class="mo" id="MathJax-Span-499" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-500" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-502" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-503" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-504" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-505"><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-507"></span><span class="mi" id="MathJax-Span-508" style="font-family: MathJax_Math-italic; padding-left: 0.158em;">μ</span><span class="mo" id="MathJax-Span-509" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-510"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-512" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-514" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="munderover" id="MathJax-Span-515" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-516" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-517"><span class="mrow" id="MathJax-Span-518"><span class="mi" id="MathJax-Span-519" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-520" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-521" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-522"><span class="mrow" id="MathJax-Span-523"><span class="mi" id="MathJax-Span-524" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-525" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-526" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-528" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-529"></span><span class="msubsup" id="MathJax-Span-530" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-531" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-532" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-533" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-534"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-535" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-536" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-537"><span class="mrow" id="MathJax-Span-538"><span class="mo" id="MathJax-Span-539" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-540"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-544" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="mi" id="MathJax-Span-545" style="font-family: MathJax_Main; padding-left: 0.209em;">log</span><span class="mo" id="MathJax-Span-546"></span><span class="mi" id="MathJax-Span-547" style="font-family: MathJax_Math-italic; padding-left: 0.158em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-548" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-549"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-551"><span class="mrow" id="MathJax-Span-552"><span class="mi" id="MathJax-Span-553" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-554" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-555" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-556"><span class="mrow" id="MathJax-Span-557"><span class="mo" id="MathJax-Span-558" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-559"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-561" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-563" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-564" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-565" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-567" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-568" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.12em, 1009.35em, 5.323em, -999.997em); top: -0.669em; left: 0em;"><span class="mtd" id="MathJax-Span-571"><span class="mrow" id="MathJax-Span-572"><span class="mi" id="MathJax-Span-573"></span><span class="mo" id="MathJax-Span-574" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-575" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-576" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-577" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="munderover" id="MathJax-Span-578" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-580"><span class="mrow" id="MathJax-Span-581"><span class="mi" id="MathJax-Span-582" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-583" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-584" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-585"><span class="mrow" id="MathJax-Span-586"><span class="mi" id="MathJax-Span-587" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-588" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-589" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-590" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-591"></span><span class="msubsup" id="MathJax-Span-592" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-595" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-596"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-597" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-598" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-599"><span class="mrow" id="MathJax-Span-600"><span class="mo" id="MathJax-Span-601" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-602"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-604" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-605" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.54em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.497em; border-left: 0px solid; width: 0px; height: 11.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi mathvariant="normal">∇</mi><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><mi>μ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo stretchy="false">)</mo><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mrow><mo>[</mo><mrow><mi>log</mi><mo>⁡</mo><mi>μ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">\begin{align}
\nabla_\theta \log p_\theta(\tau) &= \nabla \log \left(\mu(s_0) \prod_{t=0}^{T-1} \pi_\theta(a_t|s_t)P(s_{t+1}|s_t,a_t)\right) \\
&= \nabla_\theta \left[\log \mu(s_0)+ \sum_{t=0}^{T-1} (\log \pi_\theta(a_t|s_t) + \log P(s_{t+1}|s_t,a_t)) \right]\\
&= \nabla_\theta \sum_{t=0}^{T-1}\log \pi_\theta(a_t|s_t)
\end{align}</script>

<p>The probability of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-606" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1000.57em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-607"><span class="mi" id="MathJax-Span-608" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">\tau</script> decomposes into a chain of probabilities by the
Markov Decision Process assumption, whereby the next action only depends on the
current state, and the next state only depends on the current state and action.
To be explicit, we use the functions that we already defined: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-609" style="width: 1.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1000.98em, 2.43em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-610"><span class="msubsup" id="MathJax-Span-611"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-612" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-613" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">\pi_\theta</script> and
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-614" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.73em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-615"><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">P</script> for the policy and dynamics, respectively.  (Here, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-617" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.62em, 2.482em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-618"><span class="mi" id="MathJax-Span-619" style="font-family: MathJax_Math-italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">\mu</script> represents the
starting state distribution.) We also observe that when taking gradients, the
dynamics disappear!</p>

<h1 id="computing-the-raw-gradient">Computing the Raw Gradient</h1>

<p>Using the two tools above, we can now get back to our original goal, which was
to compute the gradient of the expected sum of (discounted) rewards. Formally,
let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-620" style="width: 2.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.97em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-621"><span class="mi" id="MathJax-Span-622" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-623" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-625" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-32">R(\tau)</script> be the reward function we want to optimize (i.e. maximize).
Using the above two tricks, we obtain:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-626" style="width: 28.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.66em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(2.069em, 1023.4em, 5.374em, -999.997em); top: -3.975em; left: 0em;"><span class="mrow" id="MathJax-Span-627"><span class="msubsup" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-629" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-630" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-631"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-632"><span class="mrow" id="MathJax-Span-633"><span class="mi" id="MathJax-Span-634" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-635"><span class="mrow" id="MathJax-Span-636"><span class="mi" id="MathJax-Span-637" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-638" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-639"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-640" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-641" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-642" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-643" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-644" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-645" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-646" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-647" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-648" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-649" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-650"><span class="mrow" id="MathJax-Span-651"><span class="mi" id="MathJax-Span-652" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-653"><span class="mrow" id="MathJax-Span-654"><span class="mi" id="MathJax-Span-655" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-656" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-657"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-658" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-659" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-660" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-661" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-662"><span class="mi" id="MathJax-Span-663" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-664" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-665" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-666" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-667" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="msubsup" id="MathJax-Span-668" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-669" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-670" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-671" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-672" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-673"><span class="munderover" id="MathJax-Span-674"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-675" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-676"><span class="mrow" id="MathJax-Span-677"><span class="mi" id="MathJax-Span-678" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-679" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-680" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-681"><span class="mrow" id="MathJax-Span-682"><span class="mi" id="MathJax-Span-683" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-684" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-685" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-686" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-687"></span><span class="msubsup" id="MathJax-Span-688" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-689" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-690" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-691" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-692"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-693" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-694" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-695"><span class="mrow" id="MathJax-Span-696"><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-698"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-699" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-700" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-701" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-702" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span><span class="mo" id="MathJax-Span-703" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-33">\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R(\tau)] = \mathbb{E}_{\tau \sim
\pi_\theta} \left[R(\tau) \cdot \nabla_\theta \left(\sum_{t=0}^{T-1}\log
\pi_\theta(a_t|s_t)\right)\right]</script>

<p>In the above, the expectation is with respect to the policy function, so think
of it as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-704" style="width: 3.463em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.843em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.604em, 1002.84em, 2.482em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-705"><span class="mi" id="MathJax-Span-706" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-707" style="font-family: MathJax_Main; padding-left: 0.261em;">∼</span><span class="msubsup" id="MathJax-Span-708" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-709" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-710" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">\tau \sim \pi_\theta</script>. In practice, we need trajectories to get an
empirical expectation, which estimates this actual expectation.</p>

<p>So that’s the gradient! Unfortunately, we’re not quite done yet. The naive way
is to run the agent on a batch of episodes, get a set of trajectories (call it
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-711" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1000.52em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-712"><span class="texatom" id="MathJax-Span-713"><span class="mrow" id="MathJax-Span-714"><span class="munderover" id="MathJax-Span-715"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-716" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.36em, 3.618em, -999.997em); top: -4.026em; left: 0.106em;"><span class="mo" id="MathJax-Span-717" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>τ</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-35">\hat{\tau}</script>) and update with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-718" style="width: 12.348em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.178em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1010.08em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-719"><span class="mi" id="MathJax-Span-720" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-721" style="font-family: MathJax_Main; padding-left: 0.261em;">←</span><span class="mi" id="MathJax-Span-722" style="font-family: MathJax_Math-italic; padding-left: 0.261em;">θ</span><span class="mo" id="MathJax-Span-723" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="mi" id="MathJax-Span-724" style="font-family: MathJax_Math-italic; padding-left: 0.209em;">α</span><span class="msubsup" id="MathJax-Span-725"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-726" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-727" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-728"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-729"><span class="mrow" id="MathJax-Span-730"><span class="mi" id="MathJax-Span-731" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.674em;"><span class="texatom" id="MathJax-Span-732"><span class="mrow" id="MathJax-Span-733"><span class="mi" id="MathJax-Span-734" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-735" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-736"><span class="mrow" id="MathJax-Span-737"><span class="munderover" id="MathJax-Span-738"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-739" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1000.26em, 3.773em, -999.997em); top: -4.026em; left: 0.106em;"><span class="mo" id="MathJax-Span-740" style="font-size: 70.7%; font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-741" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-742" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-743" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-744" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-745" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-746" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo stretchy="false">←</mo><mi>θ</mi><mo>+</mo><mi>α</mi><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>τ</mi><mo stretchy="false">^</mo></mover></mrow></mrow></msub><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-36">\theta \leftarrow \theta + \alpha
\nabla_\theta \mathbb{E}_{\tau \in \hat{\tau}}[R(\tau)]</script> using the empirical
expectation, but this will be too slow and unreliable due to high variance on
the gradient estimates. After one batch, we may exhibit a wide range of results:
much better performance, equal performance, or <em>worse</em> performance.  The high
variance of these gradient estimates is precisely why there has been so much
effort devoted to variance reduction techniques. (I should also add from
personal research experience that variance reduction is certainly not limited to
reinforcement learning; it also appears in many statistical projects which
concern a bias-variance tradeoff.)</p>

<h1 id="how-to-introduce-a-baseline">How to Introduce a Baseline</h1>

<p>The standard way to reduce the variance of the above gradient estimates is to
insert a <strong>baseline function</strong> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-747" style="width: 2.379em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.86em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-748"><span class="mi" id="MathJax-Span-749" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-750" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-751"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-752" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-753" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-754" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-37">b(s_t)</script> inside the expectation.</p>

<p>For concreteness, assume <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-755" style="width: 8.319em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.872em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.036em, 1006.87em, 2.637em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-756"><span class="mi" id="MathJax-Span-757" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-758" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-759" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-760" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-761" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="munderover" id="MathJax-Span-762" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1000.98em, 4.393em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-763" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.5em, 4.186em, -999.997em); top: -4.44em; left: 1.036em;"><span class="texatom" id="MathJax-Span-764"><span class="mrow" id="MathJax-Span-765"><span class="mi" id="MathJax-Span-766" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-767" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-768" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.24em, 4.135em, -999.997em); top: -3.665em; left: 1.036em;"><span class="texatom" id="MathJax-Span-769"><span class="mrow" id="MathJax-Span-770"><span class="mi" id="MathJax-Span-771" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-772" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-773" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-774" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-775" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-776" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">R(\tau) = \sum_{t=0}^{T-1}r_t</script>, so we have no
discounted rewards. We can express the policy gradient in three equivalent, but
perhaps non-intuitive ways:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-777" style="width: 31.821em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.294em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-3.097em, 1025.88em, 6.872em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-778"><span class="mtable" id="MathJax-Span-779" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 25.984em; height: 0px;"><span style="position: absolute; clip: rect(4.135em, 1006.87em, 12.244em, -999.997em); top: -8.778em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.872em; height: 0px;"><span style="position: absolute; clip: rect(2.689em, 1006.87em, 4.806em, -999.997em); top: -7.332em; right: 0em;"><span class="mtd" id="MathJax-Span-780"><span class="mrow" id="MathJax-Span-781"><span class="msubsup" id="MathJax-Span-782"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-784" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-785"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-786"><span class="mrow" id="MathJax-Span-787"><span class="mi" id="MathJax-Span-788" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-789"><span class="mrow" id="MathJax-Span-790"><span class="mi" id="MathJax-Span-791" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-792" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-793"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-794" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-795" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-796"><span class="mrow" id="MathJax-Span-797"><span class="mo" id="MathJax-Span-798" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-800" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-801" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-802" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-803"><span class="mrow" id="MathJax-Span-804"><span class="mo" id="MathJax-Span-805" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span><span class="mspace" id="MathJax-Span-806" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -3.975em; right: 0em;"><span class="mtd" id="MathJax-Span-889"><span class="mrow" id="MathJax-Span-890"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -0.669em; right: 0em;"><span class="mtd" id="MathJax-Span-971"><span class="mrow" id="MathJax-Span-972"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.784em;"></span></span><span style="position: absolute; clip: rect(5.426em, 1018.86em, 15.395em, -999.997em); top: -10.638em; left: 6.872em;"><span style="display: inline-block; position: relative; width: 19.114em; height: 0px;"><span style="position: absolute; clip: rect(2.069em, 1018.86em, 5.374em, -999.997em); top: -7.332em; left: 0em;"><span class="mtd" id="MathJax-Span-807"><span class="mrow" id="MathJax-Span-808"><span class="mi" id="MathJax-Span-809"></span><span class="texatom" id="MathJax-Span-810"><span class="mrow" id="MathJax-Span-811"><span class="mover" id="MathJax-Span-812"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.463em, 1000.73em, 3.98em, -999.997em); top: -3.975em; left: 0.003em;"><span class="mo" id="MathJax-Span-813" style="font-family: MathJax_Main;">=</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em, 1000.73em, 4.29em, -999.997em); top: -4.646em; left: 0em;"><span class="mrow" id="MathJax-Span-814"><span class="mo" id="MathJax-Span-815" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-816" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-817" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-818" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-819"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-820"><span class="mrow" id="MathJax-Span-821"><span class="mi" id="MathJax-Span-822" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-823"><span class="mrow" id="MathJax-Span-824"><span class="mi" id="MathJax-Span-825" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-826" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-827"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-828" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-829" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-830" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-831" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-832"><span class="mrow" id="MathJax-Span-833"><span class="mo" id="MathJax-Span-834" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-835"><span class="munderover" id="MathJax-Span-836"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-837" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-838"><span class="mrow" id="MathJax-Span-839"><span class="mi" id="MathJax-Span-840" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-841" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-842" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-843"><span class="mrow" id="MathJax-Span-844"><span class="mi" id="MathJax-Span-845" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-846" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-847" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-848" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-849" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-850" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-851" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span class="mo" id="MathJax-Span-852" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="msubsup" id="MathJax-Span-853" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-854" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-855" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-856" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-857" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-858"><span class="munderover" id="MathJax-Span-859"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-860" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-861"><span class="mrow" id="MathJax-Span-862"><span class="mi" id="MathJax-Span-863" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-864" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-865" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-866"><span class="mrow" id="MathJax-Span-867"><span class="mi" id="MathJax-Span-868" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-869" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-870" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-871" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-872"></span><span class="msubsup" id="MathJax-Span-873" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-874" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-875" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-876" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-877"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-878" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-879" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-880"><span class="mrow" id="MathJax-Span-881"><span class="mo" id="MathJax-Span-882" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-883"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-884" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-885" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-886" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-887" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span><span class="mo" id="MathJax-Span-888" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.12em, 1015.6em, 5.529em, -999.997em); top: -4.078em; left: 0em;"><span class="mtd" id="MathJax-Span-891"><span class="mrow" id="MathJax-Span-892"><span class="mi" id="MathJax-Span-893"></span><span class="texatom" id="MathJax-Span-894"><span class="mrow" id="MathJax-Span-895"><span class="mover" id="MathJax-Span-896"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.463em, 1000.73em, 3.98em, -999.997em); top: -3.975em; left: 0.158em;"><span class="mo" id="MathJax-Span-897" style="font-family: MathJax_Main;">=</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em, 1000.98em, 4.29em, -999.997em); top: -4.646em; left: 0em;"><span class="mrow" id="MathJax-Span-898"><span class="mo" id="MathJax-Span-899" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-900" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-901" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-902" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-903" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-904"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-905"><span class="mrow" id="MathJax-Span-906"><span class="mi" id="MathJax-Span-907" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-908"><span class="mrow" id="MathJax-Span-909"><span class="mi" id="MathJax-Span-910" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-911" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-912"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-913" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-914" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-915" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-916" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-917"><span class="munderover" id="MathJax-Span-918"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-919" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.35em, 4.238em, -999.997em); top: -2.838em; left: 0.054em;"><span class="texatom" id="MathJax-Span-920"><span class="mrow" id="MathJax-Span-921"><span class="msup" id="MathJax-Span-922"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-923" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-924" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-925" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-926" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-927"><span class="mrow" id="MathJax-Span-928"><span class="mi" id="MathJax-Span-929" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-930" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-931" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-932" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-933" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-934"><span class="mrow" id="MathJax-Span-935"><span class="msup" id="MathJax-Span-936"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-937" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-938" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="munderover" id="MathJax-Span-939" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-940" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-941"><span class="mrow" id="MathJax-Span-942"><span class="mi" id="MathJax-Span-943" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-944" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-945" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em, 1000.47em, 4.135em, -999.997em); top: -5.111em; left: 0.519em;"><span class="texatom" id="MathJax-Span-946"><span class="mrow" id="MathJax-Span-947"><span class="msup" id="MathJax-Span-948"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-949" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-950" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-951" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-952" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-953" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-954" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-955"></span><span class="msubsup" id="MathJax-Span-956" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-957" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-958" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-959" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-960"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-961" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-962" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-963"><span class="mrow" id="MathJax-Span-964"><span class="mo" id="MathJax-Span-965" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-966"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-967" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-968" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-969" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-970" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.083em;"></span></span><span style="position: absolute; clip: rect(2.12em, 1017.41em, 5.426em, -999.997em); top: -0.721em; left: 0em;"><span class="mtd" id="MathJax-Span-973"><span class="mrow" id="MathJax-Span-974"><span class="mi" id="MathJax-Span-975"></span><span class="texatom" id="MathJax-Span-976"><span class="mrow" id="MathJax-Span-977"><span class="mover" id="MathJax-Span-978"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px;"><span style="position: absolute; clip: rect(3.463em, 1000.73em, 3.98em, -999.997em); top: -3.975em; left: 0.261em;"><span class="mo" id="MathJax-Span-979" style="font-family: MathJax_Main;">=</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em, 1001.24em, 4.29em, -999.997em); top: -4.646em; left: 0em;"><span class="mrow" id="MathJax-Span-980"><span class="mo" id="MathJax-Span-981" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-982" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-983" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-984" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-985" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-986" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-987"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-988"><span class="mrow" id="MathJax-Span-989"><span class="mi" id="MathJax-Span-990" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-991"><span class="mrow" id="MathJax-Span-992"><span class="mi" id="MathJax-Span-993" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-994" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-995"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-996" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-997" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-998" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-999" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-1000"><span class="munderover" id="MathJax-Span-1001"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1002" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-1003"><span class="mrow" id="MathJax-Span-1004"><span class="mi" id="MathJax-Span-1005" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1006" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1007" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1008"><span class="mrow" id="MathJax-Span-1009"><span class="mi" id="MathJax-Span-1010" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1011" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1012" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1013" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1014" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1015" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-1016" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-1017"></span><span class="msubsup" id="MathJax-Span-1018" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1019" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-1020" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1021" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1022"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1023" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-1024" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1025"><span class="mrow" id="MathJax-Span-1026"><span class="mo" id="MathJax-Span-1027" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1028"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1029" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1030" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1031" style="font-family: MathJax_Main;">)</span><span class="mrow" id="MathJax-Span-1032" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-1033" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-1034"><span class="munderover" id="MathJax-Span-1035"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1036" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.24em, 4.238em, -999.997em); top: -2.838em; left: 0.106em;"><span class="texatom" id="MathJax-Span-1037"><span class="mrow" id="MathJax-Span-1038"><span class="msup" id="MathJax-Span-1039"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1040" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1041" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1042" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1043" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1044"><span class="mrow" id="MathJax-Span-1045"><span class="mi" id="MathJax-Span-1046" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1047" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1048" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1049" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1050" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1051"><span class="mrow" id="MathJax-Span-1052"><span class="msup" id="MathJax-Span-1053"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1054" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1055" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1056" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span><span class="mo" id="MathJax-Span-1057" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.643em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.622em; border-left: 0px solid; width: 0px; height: 11.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow><mspace width="thickmathspace"></mspace></mtd><mtd><mi></mi><mrow class="MJX-TeXAtom-ORD"><mover><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mover></mrow><mspace width="thickmathspace"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>)</mo></mrow><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mrow class="MJX-TeXAtom-ORD"><mover><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>i</mi><mo stretchy="false">)</mo></mrow></mover></mrow><mspace width="thickmathspace"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mrow class="MJX-TeXAtom-ORD"><mover><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>i</mi><mi>i</mi><mo stretchy="false">)</mo></mrow></mover></mrow><mspace width="thickmathspace"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-39">\begin{align}
\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}\Big[R(\tau)\Big] \;&{\overset{(i)}{=}}\; \mathbb{E}_{\tau \sim \pi_\theta} \left[\left(\sum_{t=0}^{T-1}r_t\right) \cdot \nabla_\theta \left(\sum_{t=0}^{T-1}\log \pi_\theta(a_t|s_t)\right)\right] \\
&{\overset{(ii)}{=}}\; \mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t'=0}^{T-1} r_{t'} \sum_{t=0}^{t'}\nabla_\theta \log \pi_\theta(a_t|s_t)\right] \\
&{\overset{(iii)}{=}}\; \mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta(a_t|s_t) \left(\sum_{t'=t}^{T-1}r_{t'}\right) \right]
\end{align}</script>

<p>Comments:</p>

<ul>
  <li>
    <p><strong>Step (i)</strong> follows from plugging in our chosen <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1058" style="width: 2.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.97em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-1059"><span class="mi" id="MathJax-Span-1060" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-1061" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1062" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1063" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-40">R(\tau)</script> into the policy
gradient we previously derived.</p>
  </li>
  <li>
    <p><strong>Step (ii)</strong> follows from first noting that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1064" style="width: 22.265em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.391em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.914em, 1018.18em, 4.032em, -999.997em); top: -3.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1065"><span class="msubsup" id="MathJax-Span-1066"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1067" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1068" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1069"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1070"><span class="mrow" id="MathJax-Span-1071"><span class="mi" id="MathJax-Span-1072" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1073"><span class="mrow" id="MathJax-Span-1074"><span class="mi" id="MathJax-Span-1075" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1076"><span class="mrow" id="MathJax-Span-1077"><span class="mo" id="MathJax-Span-1078" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="msubsup" id="MathJax-Span-1079"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1080" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1081"><span class="mrow" id="MathJax-Span-1082"><span class="msup" id="MathJax-Span-1083"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1084" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1085" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1086"><span class="mrow" id="MathJax-Span-1087"><span class="mo" id="MathJax-Span-1088" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span><span class="mo" id="MathJax-Span-1089" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-1090" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1091"><span class="mrow" id="MathJax-Span-1092"><span class="mi" id="MathJax-Span-1093" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="mi" id="MathJax-Span-1094" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1095" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-1096" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span><span class="mrow" id="MathJax-Span-1097"><span class="msubsup" id="MathJax-Span-1098"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1099" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1100"><span class="mrow" id="MathJax-Span-1101"><span class="msup" id="MathJax-Span-1102"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1104" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1105" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="munderover" id="MathJax-Span-1106" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1000.98em, 4.393em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1107" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1000.52em, 4.135em, -999.997em); top: -4.44em; left: 1.036em;"><span class="texatom" id="MathJax-Span-1108"><span class="mrow" id="MathJax-Span-1109"><span class="msup" id="MathJax-Span-1110"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1111" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1112" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.24em, 4.135em, -999.997em); top: -3.665em; left: 1.036em;"><span class="texatom" id="MathJax-Span-1113"><span class="mrow" id="MathJax-Span-1114"><span class="mi" id="MathJax-Span-1115" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1116" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1117" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1118" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1119" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-1121" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-1122"></span><span class="msubsup" id="MathJax-Span-1123" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1124" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-1125" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1126" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1127"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1128" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-1129" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1130"><span class="mrow" id="MathJax-Span-1131"><span class="mo" id="MathJax-Span-1132" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1133"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1134" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1136" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1137" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mi>τ</mi></msub><mrow><mo>[</mo><mrow><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mo>⋅</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-41">\nabla_\theta
\mathbb{E}_{\tau}\Big[r_{t'}\Big] = \mathbb{E}_\tau\left[r_{t'} \cdot
\sum_{t=0}^{t'} \nabla_\theta \log \pi_\theta(a_t|s_t)\right]</script>. The reason
why this is true can be somewhat tricky to identify. I find it easy to think
of just re-defining <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1138" style="width: 2.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.97em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-1139"><span class="mi" id="MathJax-Span-1140" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-1141" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1142" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1143" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-42">R(\tau)</script> as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1144" style="width: 1.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.98em, 2.482em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1145"><span class="msubsup" id="MathJax-Span-1146"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1147" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1148"><span class="mrow" id="MathJax-Span-1149"><span class="msup" id="MathJax-Span-1150"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1151" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1152" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-43">r_{t'}</script> for some fixed time-step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1153" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.191em, 1000.62em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1154"><span class="msup" id="MathJax-Span-1155"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.205em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1156" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.364em;"><span class="mo" id="MathJax-Span-1157" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>t</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-44">t'</script>.
Then, we do the exact same computation above to get the final result, as shown
in the equation of the “Computing the Raw Gradient” section. The main
difference now is that since we’re considering the reward at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1158" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.191em, 1000.62em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1159"><span class="msup" id="MathJax-Span-1160"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.205em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1161" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.364em;"><span class="mo" id="MathJax-Span-1162" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>t</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-45">t'</script>, our
trajectory under expectation <em>stops</em> at that time. More concretely,
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1163" style="width: 20.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.151em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.914em, 1016.95em, 4.032em, -999.997em); top: -3.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1164"><span class="msubsup" id="MathJax-Span-1165"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1166" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1167" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1168"><span style="display: inline-block; position: relative; width: 4.755em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1169"><span class="mrow" id="MathJax-Span-1170"><span class="mi" id="MathJax-Span-1171" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1172"><span class="mrow" id="MathJax-Span-1173"><span class="mo" id="MathJax-Span-1174" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1175"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1176" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="mn" id="MathJax-Span-1177" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1178" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1179"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1180" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="mn" id="MathJax-Span-1181" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1182" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1183" style="font-size: 70.7%; font-family: MathJax_Main;">…</span><span class="mo" id="MathJax-Span-1184" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1185"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1186" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-1187"><span class="mrow" id="MathJax-Span-1188"><span class="mi" id="MathJax-Span-1189" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1190" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1191"><span class="mrow" id="MathJax-Span-1192"><span class="mo" id="MathJax-Span-1193" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="msubsup" id="MathJax-Span-1194"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1195" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1196"><span class="mrow" id="MathJax-Span-1197"><span class="msup" id="MathJax-Span-1198"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1199" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1200" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1201"><span class="mrow" id="MathJax-Span-1202"><span class="mo" id="MathJax-Span-1203" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span><span class="mo" id="MathJax-Span-1204" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-1205" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1206" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1207" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1208"><span style="display: inline-block; position: relative; width: 4.755em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1209"><span class="mrow" id="MathJax-Span-1210"><span class="mi" id="MathJax-Span-1211" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1212"><span class="mrow" id="MathJax-Span-1213"><span class="mo" id="MathJax-Span-1214" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1215"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1216" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="mn" id="MathJax-Span-1217" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1218" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1219"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1220" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="mn" id="MathJax-Span-1221" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1222" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1223" style="font-size: 70.7%; font-family: MathJax_Main;">…</span><span class="mo" id="MathJax-Span-1224" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1225"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1226" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.313em;"><span class="texatom" id="MathJax-Span-1227"><span class="mrow" id="MathJax-Span-1228"><span class="msup" id="MathJax-Span-1229"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.16em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1230" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.13em; left: 0.158em;"><span class="mo" id="MathJax-Span-1231" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1232" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1233"><span class="mrow" id="MathJax-Span-1234"><span class="mo" id="MathJax-Span-1235" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="msubsup" id="MathJax-Span-1236"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1237" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1238"><span class="mrow" id="MathJax-Span-1239"><span class="msup" id="MathJax-Span-1240"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1241" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1242" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1243"><span class="mrow" id="MathJax-Span-1244"><span class="mo" id="MathJax-Span-1245" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mo stretchy="false">)</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-46">\nabla_\theta\mathbb{E}_{(s_0,a_0,\ldots,s_{T})}\Big[r_{t'}\Big] =
\nabla_\theta\mathbb{E}_{(s_0,a_0,\ldots,s_{t'})}\Big[r_{t'}\Big]</script>. This is
like “throwing away variables” when taking expectations due to “pushing
values” through sums and summing over densities (which cancel out); I have
another example later in this post which makes this explicit.</p>

    <p>Next, we sum over both sides, for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1246" style="width: 9.662em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.957em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1007.9em, 2.534em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-1247"><span class="msup" id="MathJax-Span-1248"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.205em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1249" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.364em;"><span class="mo" id="MathJax-Span-1250" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1251" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mn" id="MathJax-Span-1252" style="font-family: MathJax_Main; padding-left: 0.261em;">0</span><span class="mo" id="MathJax-Span-1253" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1254" style="font-family: MathJax_Main; padding-left: 0.158em;">1</span><span class="mo" id="MathJax-Span-1255" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1256" style="font-family: MathJax_Main; padding-left: 0.158em;">…</span><span class="mo" id="MathJax-Span-1257" style="font-family: MathJax_Main; padding-left: 0.158em;">,</span><span class="mi" id="MathJax-Span-1258" style="font-family: MathJax_Math-italic; padding-left: 0.158em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1259" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="mn" id="MathJax-Span-1260" style="font-family: MathJax_Main; padding-left: 0.209em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>T</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-47">t' = 0,1,\ldots,T-1</script>. Assuming we can
exchange the sum with the gradient, we get</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1261" style="width: 28.412em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.453em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-4.801em, 1023.2em, 8.525em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1262"><span class="mtable" id="MathJax-Span-1263" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 23.143em; height: 0px;"><span style="position: absolute; clip: rect(5.839em, 1006.25em, 16.893em, -999.997em); top: -11.723em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.356em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1006.25em, 4.393em, -999.997em); top: -8.985em; right: 0em;"><span class="mtd" id="MathJax-Span-1264"><span class="mrow" id="MathJax-Span-1265"><span class="msubsup" id="MathJax-Span-1266"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1267" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1268" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1269"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1270"><span class="mrow" id="MathJax-Span-1271"><span class="mi" id="MathJax-Span-1272" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1273"><span class="mrow" id="MathJax-Span-1274"><span class="mi" id="MathJax-Span-1275" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1276" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-1277"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-1279" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1280" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-1281" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-1282"><span class="mi" id="MathJax-Span-1283" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-1284" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1285" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1286" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1287" style="font-family: MathJax_Main;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -5.679em; right: 0em;"><span class="mtd" id="MathJax-Span-1331"><span class="mrow" id="MathJax-Span-1332"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -2.322em; right: 0em;"><span class="mtd" id="MathJax-Span-1382"><span class="mrow" id="MathJax-Span-1383"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: 1.036em; right: 0em;"><span class="mtd" id="MathJax-Span-1458"><span class="mrow" id="MathJax-Span-1459"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.728em;"></span></span><span style="position: absolute; clip: rect(7.079em, 1016.74em, 20.405em, -999.997em); top: -13.995em; left: 6.356em;"><span style="display: inline-block; position: relative; width: 16.79em; height: 0px;"><span style="position: absolute; clip: rect(2.12em, 1008.52em, 5.478em, -999.997em); top: -9.037em; left: 0em;"><span class="mtd" id="MathJax-Span-1288"><span class="mrow" id="MathJax-Span-1289"><span class="mi" id="MathJax-Span-1290"></span><span class="mo" id="MathJax-Span-1291" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-1292" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1293" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1294" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1295"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1296"><span class="mrow" id="MathJax-Span-1297"><span class="mi" id="MathJax-Span-1298" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1299"><span class="mrow" id="MathJax-Span-1300"><span class="mi" id="MathJax-Span-1301" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1302" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-1303"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1304" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-1305" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1306" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-1307" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-1308"><span class="munderover" id="MathJax-Span-1309"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1310" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.35em, 4.238em, -999.997em); top: -2.838em; left: 0.054em;"><span class="texatom" id="MathJax-Span-1311"><span class="mrow" id="MathJax-Span-1312"><span class="msup" id="MathJax-Span-1313"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1314" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1315" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1316" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1317" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1318"><span class="mrow" id="MathJax-Span-1319"><span class="mi" id="MathJax-Span-1320" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1321" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1322" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1323" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1324" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1325"><span class="mrow" id="MathJax-Span-1326"><span class="msup" id="MathJax-Span-1327"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1328" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1329" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1330" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.032em;"></span></span><span style="position: absolute; clip: rect(2.12em, 1007.8em, 5.426em, -999.997em); top: -5.679em; left: 0em;"><span class="mtd" id="MathJax-Span-1333"><span class="mrow" id="MathJax-Span-1334"><span class="mi" id="MathJax-Span-1335"></span><span class="mo" id="MathJax-Span-1336" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="munderover" id="MathJax-Span-1337" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1338" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.35em, 4.238em, -999.997em); top: -2.838em; left: 0.054em;"><span class="texatom" id="MathJax-Span-1339"><span class="mrow" id="MathJax-Span-1340"><span class="msup" id="MathJax-Span-1341"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1342" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1343" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1344" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1345" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1346"><span class="mrow" id="MathJax-Span-1347"><span class="mi" id="MathJax-Span-1348" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1349" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1350" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1351" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1352" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1353" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1354"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1355"><span class="mrow" id="MathJax-Span-1356"><span class="mi" id="MathJax-Span-1357" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.665em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1358"><span class="mrow" id="MathJax-Span-1359"><span class="msubsup" id="MathJax-Span-1360"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1361" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.181em; left: 0.416em;"><span class="texatom" id="MathJax-Span-1362"><span class="mrow" id="MathJax-Span-1363"><span class="mo" id="MathJax-Span-1364" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1365"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.16em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1366" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.13em; left: 0.158em;"><span class="mo" id="MathJax-Span-1367" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1368" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1369" style=""><span class="mrow" id="MathJax-Span-1370"><span class="mo" id="MathJax-Span-1371" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="msubsup" id="MathJax-Span-1372"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1373" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1374"><span class="mrow" id="MathJax-Span-1375"><span class="msup" id="MathJax-Span-1376"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1377" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1378" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1379" style=""><span class="mrow" id="MathJax-Span-1380"><span class="mo" id="MathJax-Span-1381" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.069em, 1015.71em, 5.426em, -999.997em); top: -2.373em; left: 0em;"><span class="mtd" id="MathJax-Span-1384"><span class="mrow" id="MathJax-Span-1385"><span class="mi" id="MathJax-Span-1386"></span><span class="mo" id="MathJax-Span-1387" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="munderover" id="MathJax-Span-1388" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1389" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1000.47em, 4.238em, -999.997em); top: -2.838em; left: 0.519em;"><span class="texatom" id="MathJax-Span-1390"><span class="mrow" id="MathJax-Span-1391"><span class="msup" id="MathJax-Span-1392"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1393" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1394" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1395"><span class="mrow" id="MathJax-Span-1396"><span class="mi" id="MathJax-Span-1397" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1398" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1399" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1400" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1401"><span class="mrow" id="MathJax-Span-1402"><span class="mi" id="MathJax-Span-1403" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.665em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1404"><span class="mrow" id="MathJax-Span-1405"><span class="msubsup" id="MathJax-Span-1406"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1407" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.181em; left: 0.416em;"><span class="texatom" id="MathJax-Span-1408"><span class="mrow" id="MathJax-Span-1409"><span class="mo" id="MathJax-Span-1410" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1411"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.16em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1412" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.13em; left: 0.158em;"><span class="mo" id="MathJax-Span-1413" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1414" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1415" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-1416" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-1417"><span class="msubsup" id="MathJax-Span-1418"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1419" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1420"><span class="mrow" id="MathJax-Span-1421"><span class="msup" id="MathJax-Span-1422"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1423" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1424" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1425" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="munderover" id="MathJax-Span-1426" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1427" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-1428"><span class="mrow" id="MathJax-Span-1429"><span class="mi" id="MathJax-Span-1430" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1431" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1432" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em, 1000.47em, 4.135em, -999.997em); top: -5.111em; left: 0.519em;"><span class="texatom" id="MathJax-Span-1433"><span class="mrow" id="MathJax-Span-1434"><span class="msup" id="MathJax-Span-1435"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1436" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1437" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1438" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1439" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1440" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-1441" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-1442"></span><span class="msubsup" id="MathJax-Span-1443" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1444" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-1445" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1446" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1447"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1448" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-1449" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1450"><span class="mrow" id="MathJax-Span-1451"><span class="mo" id="MathJax-Span-1452" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1453"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1454" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1455" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1456" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1457" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.032em;"></span></span><span style="position: absolute; clip: rect(2.069em, 1016.74em, 5.426em, -999.997em); top: 0.984em; left: 0em;"><span class="mtd" id="MathJax-Span-1460"><span class="mrow" id="MathJax-Span-1461"><span class="mi" id="MathJax-Span-1462"></span><span class="mo" id="MathJax-Span-1463" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-1464" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1465"><span class="mrow" id="MathJax-Span-1466"><span class="mi" id="MathJax-Span-1467" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1468"><span class="mrow" id="MathJax-Span-1469"><span class="mi" id="MathJax-Span-1470" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1471" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-1472"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1473" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-1474" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1475" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-1476" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-1477"><span class="munderover" id="MathJax-Span-1478"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1479" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1000.47em, 4.238em, -999.997em); top: -2.838em; left: 0.519em;"><span class="texatom" id="MathJax-Span-1480"><span class="mrow" id="MathJax-Span-1481"><span class="msup" id="MathJax-Span-1482"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1483" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1484" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1485"><span class="mrow" id="MathJax-Span-1486"><span class="mi" id="MathJax-Span-1487" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1488" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1489" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1490" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1491" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1492"><span class="mrow" id="MathJax-Span-1493"><span class="msup" id="MathJax-Span-1494"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1495" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1496" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1497" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="munderover" id="MathJax-Span-1498" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1499" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-1500"><span class="mrow" id="MathJax-Span-1501"><span class="mi" id="MathJax-Span-1502" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1503" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1504" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em, 1000.47em, 4.135em, -999.997em); top: -5.111em; left: 0.519em;"><span class="texatom" id="MathJax-Span-1505"><span class="mrow" id="MathJax-Span-1506"><span class="msup" id="MathJax-Span-1507"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1508" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1509" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1510" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1511" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1512" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-1513" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-1514"></span><span class="msubsup" id="MathJax-Span-1515" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1516" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-1517" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1518" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1519"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1520" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-1521" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1522"><span class="mrow" id="MathJax-Span-1523"><span class="mo" id="MathJax-Span-1524" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1525"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1526" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1527" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1528" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1529" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span><span class="mo" id="MathJax-Span-1530" style="font-family: MathJax_Main; padding-left: 0.158em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 14.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -7.622em; border-left: 0px solid; width: 0px; height: 15.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></mtd><mtd><mi></mi><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msup><mi>τ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><msup><mi>t</mi><mo>′</mo></msup><mo stretchy="false">)</mo></mrow></msup></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msup><mi>τ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><msup><mi>t</mi><mo>′</mo></msup><mo stretchy="false">)</mo></mrow></msup></mrow></msub><mrow><mo>[</mo><mrow><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mo>⋅</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mo>⋅</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow><mo>.</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">\begin{align}
\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta} \left[ R(\tau) \right] &= \nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t'=0}^{T-1} r_{t'}\right] \\
&= \sum_{t'=0}^{T-1}\nabla_\theta \mathbb{E}_{\tau^{(t')}} \Big[r_{t'}\Big] \\
&= \sum_{t'}^{T-1} \mathbb{E}_{\tau^{(t')}}\left[r_{t'} \cdot \sum_{t=0}^{t'} \nabla_\theta \log \pi_\theta(a_t|s_t)\right] \\
&= \mathbb{E}_{\tau \sim \pi_\theta}\left[ \sum_{t'}^{T-1}  r_{t'} \cdot \sum_{t=0}^{t'} \nabla_\theta \log \pi_\theta(a_t|s_t)\right].
\end{align}</script>

    <p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1531" style="width: 2.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1001.65em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1532"><span class="msubsup" id="MathJax-Span-1533"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1534" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.571em;"><span class="texatom" id="MathJax-Span-1535"><span class="mrow" id="MathJax-Span-1536"><span class="mo" id="MathJax-Span-1537" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1538"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1539" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1540" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1541" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>τ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><msup><mi>t</mi><mo>′</mo></msup><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-49">\tau^{(t')}</script> indicates the trajectory up to time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1542" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.191em, 1000.62em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1543"><span class="msup" id="MathJax-Span-1544"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.205em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1545" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.364em;"><span class="mo" id="MathJax-Span-1546" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>t</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-50">t'</script>. (Full
disclaimer: I’m not sure if this formalism with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1547" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1000.57em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1548"><span class="mi" id="MathJax-Span-1549" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">\tau</script> is needed, and I
think most people would do this computation without worrying about the precise
expectation details.)</p>
  </li>
  <li>
    <p><strong>Step (iii)</strong> follows from a nifty algebra trick. To simplify the subsequent
notation, let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1550" style="width: 10.85em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.939em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1008.84em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-1551"><span class="msubsup" id="MathJax-Span-1552"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1553" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1554" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1555" style="font-family: MathJax_Main; padding-left: 0.261em;">:<span style="font-family: MathJax_Main;">=</span></span><span class="msubsup" id="MathJax-Span-1556" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1557" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1558" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-1559" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-1560"></span><span class="msubsup" id="MathJax-Span-1561" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1562" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-1563" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1564" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1565"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1566" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-1567" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1568"><span class="mrow" id="MathJax-Span-1569"><span class="mo" id="MathJax-Span-1570" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1571"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1572" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1573" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1574" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>t</mi></msub><mo>:=</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-52">f_t := \nabla_\theta \log \pi_\theta(a_t|s_t)</script>. In addition,
<strong>ignore the expectation</strong>; we’ll only re-arrange the inside here.  With this
substitution and setup, the sum inside the expectation from <strong>Step (ii)</strong>
turns out to be</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1575" style="width: 21.387em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.668em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-1.392em, 1017.51em, 5.116em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1576"><span class="mtable" id="MathJax-Span-1577" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 17.358em; height: 0px;"><span style="position: absolute; clip: rect(3.722em, 1002.84em, 10.127em, -999.997em); top: -7.126em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.843em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1001.81em, 4.341em, -999.997em); top: -6.557em; right: 0em;"><span class="mtd" id="MathJax-Span-1578"><span class="mrow" id="MathJax-Span-1579"><span class="msubsup" id="MathJax-Span-1580"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1581" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1582" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1583"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1584" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1585" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1001.81em, 4.341em, -999.997em); top: -5.214em; right: 0em;"><span class="mtd" id="MathJax-Span-1590"><span class="mrow" id="MathJax-Span-1591"><span class="msubsup" id="MathJax-Span-1592"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1593" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1594" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1595"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1596" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1597" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1001.81em, 4.341em, -999.997em); top: -3.923em; right: 0em;"><span class="mtd" id="MathJax-Span-1609"><span class="mrow" id="MathJax-Span-1610"><span class="msubsup" id="MathJax-Span-1611"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1612" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1613" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1614"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1615" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1616" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1001.09em, 3.928em, -999.997em); top: -2.632em; right: 0em;"><span class="mtd" id="MathJax-Span-1635"><span class="mrow" id="MathJax-Span-1636"><span class="mo" id="MathJax-Span-1637" style="font-family: MathJax_Main;">⋯</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1002.84em, 4.341em, -999.997em); top: -1.34em; right: 0em;"><span class="mtd" id="MathJax-Span-1638"><span class="mrow" id="MathJax-Span-1639"><span class="msubsup" id="MathJax-Span-1640"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1641" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1642"><span class="mrow" id="MathJax-Span-1643"><span class="mi" id="MathJax-Span-1644" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1645" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1646" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1647"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1648" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1649" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.131em;"></span></span><span style="position: absolute; clip: rect(3.722em, 1014.52em, 10.023em, -999.997em); top: -7.022em; left: 2.843em;"><span style="display: inline-block; position: relative; width: 14.517em; height: 0px;"><span style="position: absolute; clip: rect(3.257em, 1000.73em, 4.238em, -999.997em); top: -6.557em; left: 0em;"><span class="mtd" id="MathJax-Span-1586"><span class="mrow" id="MathJax-Span-1587"><span class="mi" id="MathJax-Span-1588"></span><span class="mo" id="MathJax-Span-1589" style="font-family: MathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1003.72em, 4.341em, -999.997em); top: -5.214em; left: 0em;"><span class="mtd" id="MathJax-Span-1598"><span class="mrow" id="MathJax-Span-1599"><span class="mi" id="MathJax-Span-1600"></span><span class="mo" id="MathJax-Span-1601" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="msubsup" id="MathJax-Span-1602" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1603" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1604" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1605"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1606" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1607" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1608" style="font-family: MathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1006.72em, 4.341em, -999.997em); top: -3.923em; left: 0em;"><span class="mtd" id="MathJax-Span-1617"><span class="mrow" id="MathJax-Span-1618"><span class="mi" id="MathJax-Span-1619"></span><span class="mo" id="MathJax-Span-1620" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="msubsup" id="MathJax-Span-1621" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1622" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1623" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1624"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1625" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1626" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1627" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="msubsup" id="MathJax-Span-1628" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1629" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1630" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1631"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1632" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1633" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1634" style="font-family: MathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.102em, 1014.52em, 4.341em, -999.997em); top: -1.34em; left: 0em;"><span class="mtd" id="MathJax-Span-1650"><span class="mrow" id="MathJax-Span-1651"><span class="mi" id="MathJax-Span-1652"></span><span class="mo" id="MathJax-Span-1653" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="msubsup" id="MathJax-Span-1654" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1655" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1656"><span class="mrow" id="MathJax-Span-1657"><span class="mi" id="MathJax-Span-1658" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1659" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1660" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1661"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1662" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1663" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1664" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="msubsup" id="MathJax-Span-1665" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1666" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1667"><span class="mrow" id="MathJax-Span-1668"><span class="mi" id="MathJax-Span-1669" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1670" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1671" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1672"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1673" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1674" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1675" style="font-family: MathJax_Main; padding-left: 0.158em;">⋯</span><span class="mo" id="MathJax-Span-1676" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="msubsup" id="MathJax-Span-1677" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1678" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1679"><span class="mrow" id="MathJax-Span-1680"><span class="mi" id="MathJax-Span-1681" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1682" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1683" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1684"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1685" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1686"><span class="mrow" id="MathJax-Span-1687"><span class="mi" id="MathJax-Span-1688" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1689" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1690" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.497em; border-left: 0px solid; width: 0px; height: 7.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>r</mi><mn>0</mn></msub><msub><mi>f</mi><mn>0</mn></msub></mtd><mtd><mi></mi><mo>+</mo></mtd></mtr><mtr><mtd><msub><mi>r</mi><mn>1</mn></msub><msub><mi>f</mi><mn>0</mn></msub></mtd><mtd><mi></mi><mo>+</mo><msub><mi>r</mi><mn>1</mn></msub><msub><mi>f</mi><mn>1</mn></msub><mo>+</mo></mtd></mtr><mtr><mtd><msub><mi>r</mi><mn>2</mn></msub><msub><mi>f</mi><mn>0</mn></msub></mtd><mtd><mi></mi><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><msub><mi>f</mi><mn>1</mn></msub><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><msub><mi>f</mi><mn>2</mn></msub><mo>+</mo></mtd></mtr><mtr><mtd><mo>⋯</mo></mtd></mtr><mtr><mtd><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>f</mi><mn>0</mn></msub></mtd><mtd><mi></mi><mo>+</mo><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>f</mi><mn>1</mn></msub><mo>+</mo><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>f</mi><mn>2</mn></msub><mo>⋯</mo><mo>+</mo><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-53">\begin{align}
r_0f_0 &+ \\
r_1f_0 &+ r_1f_1 + \\
r_2f_0 &+ r_2f_1 + r_2f_2 + \\
\cdots \\
r_{T-1}f_0 &+ r_{T-1}f_1 + r_{T-1}f_2 \cdots + r_{T-1}f_{T-1}
\end{align}</script>

    <p>In other words, each <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1691" style="width: 1.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.98em, 2.482em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1692"><span class="msubsup" id="MathJax-Span-1693"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1694" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1695"><span class="mrow" id="MathJax-Span-1696"><span class="msup" id="MathJax-Span-1697"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1698" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1699" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-54">r_{t'}</script> has its own <em>row</em> of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1700" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1000.57em, 2.482em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1701"><span class="mi" id="MathJax-Span-1702" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">f</script>-value to which it
gets distributed. Next, <em>switch to the column view</em>: instead of summing
row-wise, sum <em>column-wise</em>. The first column is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1703" style="width: 7.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.304em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.914em, 1006.1em, 4.032em, -999.997em); top: -3.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1704"><span class="msubsup" id="MathJax-Span-1705"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1706" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1707" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1708" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="mrow" id="MathJax-Span-1709" style="padding-left: 0.209em;"><span class="mo" id="MathJax-Span-1710" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-1711"><span class="munderover" id="MathJax-Span-1712"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1000.98em, 4.393em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1713" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.5em, 4.186em, -999.997em); top: -4.44em; left: 1.036em;"><span class="texatom" id="MathJax-Span-1714"><span class="mrow" id="MathJax-Span-1715"><span class="mi" id="MathJax-Span-1716" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1717" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1718" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.24em, 4.135em, -999.997em); top: -3.665em; left: 1.036em;"><span class="texatom" id="MathJax-Span-1719"><span class="mrow" id="MathJax-Span-1720"><span class="mi" id="MathJax-Span-1721" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1722" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1723" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1724" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1725" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1726" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1727" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>0</mn></msub><mo>⋅</mo><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-56">f_0 \cdot
\left(\sum_{t=0}^{T-1}r_t\right)</script>. The second is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1728" style="width: 7.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.304em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.914em, 1006.1em, 4.032em, -999.997em); top: -3.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1729"><span class="msubsup" id="MathJax-Span-1730"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1731" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1732" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1733" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="mrow" id="MathJax-Span-1734" style="padding-left: 0.209em;"><span class="mo" id="MathJax-Span-1735" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-1736"><span class="munderover" id="MathJax-Span-1737"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1000.98em, 4.393em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1738" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.5em, 4.186em, -999.997em); top: -4.44em; left: 1.036em;"><span class="texatom" id="MathJax-Span-1739"><span class="mrow" id="MathJax-Span-1740"><span class="mi" id="MathJax-Span-1741" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1742" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1743" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.24em, 4.135em, -999.997em); top: -3.665em; left: 1.036em;"><span class="texatom" id="MathJax-Span-1744"><span class="mrow" id="MathJax-Span-1745"><span class="mi" id="MathJax-Span-1746" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1747" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1748" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1749" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1750" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1751" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1752" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub><mo>⋅</mo><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-57">f_1 \cdot
\left(\sum_{t=1}^{T-1}r_t\right)</script>. And so on. Doing this means we get the
desired formula after replacing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1753" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1000.83em, 2.482em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1754"><span class="msubsup" id="MathJax-Span-1755"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1756" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1757" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-58">f_t</script> with its real meaning and hitting the
expression with an expectation.</p>
  </li>
</ul>

<p>Note: it is <em>very easy</em> to make a typo with these. I checked my math carefully
and cross-referenced it with references online (which <em>themselves</em> have typos).
If any readers find a typo, please let me know.</p>

<p>Using the above formulation, we finally introduce our baseline <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1758" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1759"><span class="mi" id="MathJax-Span-1760" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-59">b</script>, which is a
function of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1761" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.78em, 2.43em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1762"><span class="msubsup" id="MathJax-Span-1763"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1764" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1765" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">s_t</script> (and <em>not</em> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1766" style="width: 1.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.98em, 2.482em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1767"><span class="msubsup" id="MathJax-Span-1768"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1769" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1770"><span class="mrow" id="MathJax-Span-1771"><span class="msup" id="MathJax-Span-1772"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1773" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1774" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-61">s_{t'}</script>, I believe). We “insert” it inside the
term in parentheses:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1775" style="width: 32.441em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.81em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(2.069em, 1026.55em, 5.374em, -999.997em); top: -3.975em; left: 0em;"><span class="mrow" id="MathJax-Span-1776"><span class="msubsup" id="MathJax-Span-1777"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1778" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1779" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1780"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1781"><span class="mrow" id="MathJax-Span-1782"><span class="mi" id="MathJax-Span-1783" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1784"><span class="mrow" id="MathJax-Span-1785"><span class="mi" id="MathJax-Span-1786" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1787" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-1788"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1789" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-1790" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1791" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1792" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-1793" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1794" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1795" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1796" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1797" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-1798" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1799"><span class="mrow" id="MathJax-Span-1800"><span class="mi" id="MathJax-Span-1801" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1802"><span class="mrow" id="MathJax-Span-1803"><span class="mi" id="MathJax-Span-1804" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1805" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-1806"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1807" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-1808" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1809" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-1810" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-1811"><span class="munderover" id="MathJax-Span-1812"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1813" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-1814"><span class="mrow" id="MathJax-Span-1815"><span class="mi" id="MathJax-Span-1816" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1817" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1818" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1819"><span class="mrow" id="MathJax-Span-1820"><span class="mi" id="MathJax-Span-1821" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1822" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1823" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1824" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1825" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1826" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-1827" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-1828"></span><span class="msubsup" id="MathJax-Span-1829" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1830" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-1831" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1832" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1833"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1834" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-1835" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1836"><span class="mrow" id="MathJax-Span-1837"><span class="mo" id="MathJax-Span-1838" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1839"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1840" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1841" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1842" style="font-family: MathJax_Main;">)</span><span class="mrow" id="MathJax-Span-1843" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-1844" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-1845"><span class="munderover" id="MathJax-Span-1846"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1847" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.24em, 4.238em, -999.997em); top: -2.838em; left: 0.106em;"><span class="texatom" id="MathJax-Span-1848"><span class="mrow" id="MathJax-Span-1849"><span class="msup" id="MathJax-Span-1850"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1851" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1852" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1853" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1854" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1855"><span class="mrow" id="MathJax-Span-1856"><span class="mi" id="MathJax-Span-1857" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1858" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1859" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1860" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1861" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1862"><span class="mrow" id="MathJax-Span-1863"><span class="msup" id="MathJax-Span-1864"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1865" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1866" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1867" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="mi" id="MathJax-Span-1868" style="font-family: MathJax_Math-italic; padding-left: 0.209em;">b</span><span class="mo" id="MathJax-Span-1869" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1870"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1871" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1872" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1873" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-1874" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span><span class="mo" id="MathJax-Span-1875" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mo>−</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-62">\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R(\tau)] =
\mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t=0}^{T-1} \nabla_\theta \log
\pi_\theta(a_t|s_t) \left(\sum_{t'=t}^{T-1}r_{t'} - b(s_t)\right) \right]</script>

<p>At first glance, it doesn’t seem like this will be helpful, and one might wonder
if this would cause the gradient estimate to become biased. Fortunately, it
turns out that this is not a problem. This was surprising to me, because all we
know is that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1876" style="width: 2.379em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.86em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-1877"><span class="mi" id="MathJax-Span-1878" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-1879" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1880"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1881" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1882" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1883" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-63">b(s_t)</script> is a function of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1884" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.78em, 2.43em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1885"><span class="msubsup" id="MathJax-Span-1886"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1887" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1888" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-64">s_t</script>. However, this is a bit
misleading because usually we want <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1889" style="width: 2.379em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.86em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-1890"><span class="mi" id="MathJax-Span-1891" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-1892" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1893"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1894" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1895" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1896" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-65">b(s_t)</script> to be the <em>expected return</em>
starting at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1897" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1000.31em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1898"><span class="mi" id="MathJax-Span-1899" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-66">t</script>, which means it really “depends” on the subsequent time
steps. For now, though, just think of it as a function of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1900" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.78em, 2.43em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1901"><span class="msubsup" id="MathJax-Span-1902"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1903" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1904" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-67">s_t</script>.</p>

<h1 id="understanding-the-baseline">Understanding the Baseline</h1>

<p>In this section, I first go over why inserting <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1905" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-1906"><span class="mi" id="MathJax-Span-1907" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-68">b</script> above doesn’t make
our gradient estimate biased. Next, I will go over why the baseline reduces
variance of the gradient estimate. These two capture the best of both worlds:
staying unbiased and reducing variance. In general, any time you have an
unbiased estimate and it remains so after applying a variance reduction
technique, then apply that variance reduction!</p>

<p>First, let’s show that the gradient estimate is unbiased.  We see that with the
baseline, we can distribute and rearrange and get:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1908" style="width: 42.255em; display: inline-block;"><span style="display: inline-block; position: relative; width: 34.92em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(2.069em, 1034.66em, 5.374em, -999.997em); top: -3.975em; left: 0em;"><span class="mrow" id="MathJax-Span-1909"><span class="msubsup" id="MathJax-Span-1910"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1911" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1912" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1913"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1914"><span class="mrow" id="MathJax-Span-1915"><span class="mi" id="MathJax-Span-1916" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1917"><span class="mrow" id="MathJax-Span-1918"><span class="mi" id="MathJax-Span-1919" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1920" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-1921"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1922" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-1923" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1924" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1925" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-1926" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1927" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1928" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1929" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1930" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-1931" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-1932"><span class="mrow" id="MathJax-Span-1933"><span class="mi" id="MathJax-Span-1934" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-1935"><span class="mrow" id="MathJax-Span-1936"><span class="mi" id="MathJax-Span-1937" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1938" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-1939"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1940" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-1941" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1942" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-1943" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-1944"><span class="munderover" id="MathJax-Span-1945"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1946" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-1947"><span class="mrow" id="MathJax-Span-1948"><span class="mi" id="MathJax-Span-1949" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1950" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1951" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1952"><span class="mrow" id="MathJax-Span-1953"><span class="mi" id="MathJax-Span-1954" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1955" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1956" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1957" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1958" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-1959" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-1960" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-1961"></span><span class="msubsup" id="MathJax-Span-1962" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1963" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-1964" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1965" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1966"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1967" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-1968" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1969"><span class="mrow" id="MathJax-Span-1970"><span class="mo" id="MathJax-Span-1971" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1972"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1973" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-1974" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1975" style="font-family: MathJax_Main;">)</span><span class="mrow" id="MathJax-Span-1976" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-1977" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-1978"><span class="munderover" id="MathJax-Span-1979"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-1980" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.24em, 4.238em, -999.997em); top: -2.838em; left: 0.106em;"><span class="texatom" id="MathJax-Span-1981"><span class="mrow" id="MathJax-Span-1982"><span class="msup" id="MathJax-Span-1983"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1984" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1985" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-1986" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1987" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1988"><span class="mrow" id="MathJax-Span-1989"><span class="mi" id="MathJax-Span-1990" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-1991" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1992" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1993" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1994" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1995"><span class="mrow" id="MathJax-Span-1996"><span class="msup" id="MathJax-Span-1997"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1998" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-1999" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-2000" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span class="mo" id="MathJax-Span-2001" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="munderover" id="MathJax-Span-2002" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-2003" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-2004"><span class="mrow" id="MathJax-Span-2005"><span class="mi" id="MathJax-Span-2006" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2007" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2008" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2009"><span class="mrow" id="MathJax-Span-2010"><span class="mi" id="MathJax-Span-2011" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2012" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2013" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2014" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2015" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-2016" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2017" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-2018"></span><span class="msubsup" id="MathJax-Span-2019" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2020" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2021" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2022" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2023"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2024" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2025" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2026"><span class="mrow" id="MathJax-Span-2027"><span class="mo" id="MathJax-Span-2028" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2029"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2030" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2031" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2032" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-2033" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-2034" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2035"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2036" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2037" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2038" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-2039" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub></mrow><mo>)</mo></mrow><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-69">\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R(\tau)] =
\mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t=0}^{T-1} \nabla_\theta \log
\pi_\theta(a_t|s_t) \left(\sum_{t'=t}^{T-1}r_{t'}\right) - \sum_{t=0}^{T-1}
\nabla_\theta \log \pi_\theta(a_t|s_t) b(s_t) \right]</script>

<p>Due to linearity of expectation, all we need to show is that for any single time
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2040" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1000.31em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2041"><span class="mi" id="MathJax-Span-2042" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">t</script>, the gradient of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2043" style="width: 6.201em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.116em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1005.01em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-2044"><span class="mi" id="MathJax-Span-2045" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-2046"></span><span class="msubsup" id="MathJax-Span-2047" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2048" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2049" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2050" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2051"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2052" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2053" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2054"><span class="mrow" id="MathJax-Span-2055"><span class="mo" id="MathJax-Span-2056" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2057"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2058" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2059" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2060" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-71">\log \pi_\theta(a_t|s_t)</script> multiplied with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2061" style="width: 2.379em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.86em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-2062"><span class="mi" id="MathJax-Span-2063" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-2064" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2065"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2066" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2067" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2068" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-72">b(s_t)</script>
is zero. This is true because</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2069" style="width: 38.846em; display: inline-block;"><span style="display: inline-block; position: relative; width: 32.079em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-2.89em, 1031.72em, 6.614em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2070"><span class="mtable" id="MathJax-Span-2071" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 31.769em; height: 0px;"><span style="position: absolute; clip: rect(4.548em, 1011.62em, 13.432em, -999.997em); top: -9.553em; left: 0em;"><span style="display: inline-block; position: relative; width: 11.831em; height: 0px;"><span style="position: absolute; clip: rect(2.689em, 1011.62em, 4.806em, -999.997em); top: -7.694em; right: 0em;"><span class="mtd" id="MathJax-Span-2072"><span class="mrow" id="MathJax-Span-2073"><span class="msubsup" id="MathJax-Span-2074"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2075"><span class="mrow" id="MathJax-Span-2076"><span class="mi" id="MathJax-Span-2077" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-2078"><span class="mrow" id="MathJax-Span-2079"><span class="mi" id="MathJax-Span-2080" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2081" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-2082"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2083" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-2084" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2085"><span class="mrow" id="MathJax-Span-2086"><span class="mo" id="MathJax-Span-2087" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="msubsup" id="MathJax-Span-2088"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2089" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-2090" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2091" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-2092"></span><span class="msubsup" id="MathJax-Span-2093" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2094" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2095" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2096" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2097"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2098" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2099" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2100"><span class="mrow" id="MathJax-Span-2101"><span class="mo" id="MathJax-Span-2102" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2103"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2104" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2105" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2106" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-2107" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-2108" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2109"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2110" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2111" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2112" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-2113"><span class="mrow" id="MathJax-Span-2114"><span class="mo" id="MathJax-Span-2115" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -5.576em; right: 0em;"><span class="mtd" id="MathJax-Span-2201"><span class="mrow" id="MathJax-Span-2202"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -2.373em; right: 0em;"><span class="mtd" id="MathJax-Span-2298"><span class="mrow" id="MathJax-Span-2299"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -0.256em; right: 0em;"><span class="mtd" id="MathJax-Span-2370"><span class="mrow" id="MathJax-Span-2371"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.558em;"></span></span><span style="position: absolute; clip: rect(5.22em, 1019.73em, 14.724em, -999.997em); top: -10.225em; left: 11.831em;"><span style="display: inline-block; position: relative; width: 19.941em; height: 0px;"><span style="position: absolute; clip: rect(2.689em, 1019.01em, 4.806em, -999.997em); top: -7.694em; left: 0em;"><span class="mtd" id="MathJax-Span-2116"><span class="mrow" id="MathJax-Span-2117"><span class="mi" id="MathJax-Span-2118"></span><span class="mo" id="MathJax-Span-2119" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-2120" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 3.515em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2121"><span class="mrow" id="MathJax-Span-2122"><span class="mi" id="MathJax-Span-2123" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-2124"><span class="mrow" id="MathJax-Span-2125"><span class="msubsup" id="MathJax-Span-2126"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2127" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2128"><span class="mrow" id="MathJax-Span-2129"><span class="mn" id="MathJax-Span-2130" style="font-size: 50%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2131" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2132" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2133" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2134"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2136"><span class="mrow" id="MathJax-Span-2137"><span class="mn" id="MathJax-Span-2138" style="font-size: 50%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2139" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2140" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2141" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2142" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2143"><span class="mrow" id="MathJax-Span-2144"><span class="mo" id="MathJax-Span-2145" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="msubsup" id="MathJax-Span-2146"><span style="display: inline-block; position: relative; width: 4.393em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2147"><span class="mrow" id="MathJax-Span-2148"><span class="mi" id="MathJax-Span-2149" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-2150"><span class="mrow" id="MathJax-Span-2151"><span class="msubsup" id="MathJax-Span-2152"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2153" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2154"><span class="mrow" id="MathJax-Span-2155"><span class="mi" id="MathJax-Span-2156" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2157" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2158" style="font-size: 50%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2159" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2160" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2161" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2162"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2164"><span class="mrow" id="MathJax-Span-2165"><span class="mi" id="MathJax-Span-2166" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2167" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2168" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2169" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2170" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2171" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-2172"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2173" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-2174" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2175" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-2176"></span><span class="msubsup" id="MathJax-Span-2177" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2178" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2179" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2180" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2181"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2182" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2184"><span class="mrow" id="MathJax-Span-2185"><span class="mo" id="MathJax-Span-2186" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2187"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2188" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2189" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2190" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-2191" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-2192" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2193"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2194" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2195" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2196" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2197" style="font-family: MathJax_Main;">]</span><span class="texatom" id="MathJax-Span-2198"><span class="mrow" id="MathJax-Span-2199"><span class="mo" id="MathJax-Span-2200" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.689em, 1019.73em, 5.891em, -999.997em); top: -5.576em; left: 0em;"><span class="mtd" id="MathJax-Span-2203"><span class="mrow" id="MathJax-Span-2204"><span class="mi" id="MathJax-Span-2205"></span><span class="mo" id="MathJax-Span-2206" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-2207" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 3.515em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2208"><span class="mrow" id="MathJax-Span-2209"><span class="mi" id="MathJax-Span-2210" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-2211"><span class="mrow" id="MathJax-Span-2212"><span class="msubsup" id="MathJax-Span-2213"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2214" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2215"><span class="mrow" id="MathJax-Span-2216"><span class="mn" id="MathJax-Span-2217" style="font-size: 50%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2218" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2219" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2220" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2221"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2223"><span class="mrow" id="MathJax-Span-2224"><span class="mn" id="MathJax-Span-2225" style="font-size: 50%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2226" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2227" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2228" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2229" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2230" style=""><span class="mrow" id="MathJax-Span-2231"><span class="mo" id="MathJax-Span-2232" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="mi" id="MathJax-Span-2233" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-2234" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2235"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2236" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2237" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2238" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2239" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="munderover" id="MathJax-Span-2240" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 11.47em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1011.47em, 5.168em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2241"><span class="mrow" id="MathJax-Span-2242"><span class="munderover" id="MathJax-Span-2243"><span style="display: inline-block; position: relative; width: 11.47em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1011.32em, 4.445em, -999.997em); top: -3.975em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2244"><span class="msubsup" id="MathJax-Span-2245"><span style="display: inline-block; position: relative; width: 4.393em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2246"><span class="mrow" id="MathJax-Span-2247"><span class="mi" id="MathJax-Span-2248" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-2249"><span class="mrow" id="MathJax-Span-2250"><span class="msubsup" id="MathJax-Span-2251"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2253"><span class="mrow" id="MathJax-Span-2254"><span class="mi" id="MathJax-Span-2255" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2256" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2257" style="font-size: 50%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2258" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2259" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2260" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2261"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2262" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2263"><span class="mrow" id="MathJax-Span-2264"><span class="mi" id="MathJax-Span-2265" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2266" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2267" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2268" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2269" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2270" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-2271"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2272" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-2273" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2274" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-2275"></span><span class="msubsup" id="MathJax-Span-2276" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2277" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2279" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2280"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2281" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2282" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2283"><span class="mrow" id="MathJax-Span-2284"><span class="mo" id="MathJax-Span-2285" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2286"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2287" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2288" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2289" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2290" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.81em, 1011.47em, 2.637em, -999.997em); top: -1.444em; left: 0em;"><span class="mo" id="MathJax-Span-2291" style=""><span style="display: inline-block; position: relative; width: 11.47em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.975em; left: 0.003em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.975em; left: 11.005em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.975em; left: 5.271em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 0.416em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 0.726em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 1.087em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 1.449em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 1.81em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 2.172em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 2.482em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 2.843em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 3.205em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 3.567em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 3.877em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 4.238em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 4.6em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 4.961em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 6.098em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 6.459em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 6.821em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 7.182em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 7.492em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 7.854em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 8.215em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 8.577em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 8.887em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 9.248em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 9.61em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 9.972em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 10.333em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 10.643em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.238em, -999.997em); top: -2.322em; left: 5.478em;"><span class="texatom" id="MathJax-Span-2292"><span class="mrow" id="MathJax-Span-2293"><span class="mi" id="MathJax-Span-2294" style="font-size: 70.7%; font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2295" style=""><span class="mrow" id="MathJax-Span-2296"><span class="mo" id="MathJax-Span-2297" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.689em, 1016.69em, 4.806em, -999.997em); top: -2.373em; left: 0em;"><span class="mtd" id="MathJax-Span-2300"><span class="mrow" id="MathJax-Span-2301"><span class="mi" id="MathJax-Span-2302"></span><span class="mo" id="MathJax-Span-2303" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-2304" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 3.515em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2305"><span class="mrow" id="MathJax-Span-2306"><span class="mi" id="MathJax-Span-2307" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-2308"><span class="mrow" id="MathJax-Span-2309"><span class="msubsup" id="MathJax-Span-2310"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2311" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2312"><span class="mrow" id="MathJax-Span-2313"><span class="mn" id="MathJax-Span-2314" style="font-size: 50%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2315" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2316" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2317" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2318"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2320"><span class="mrow" id="MathJax-Span-2321"><span class="mn" id="MathJax-Span-2322" style="font-size: 50%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2323" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2324" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2325" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2326" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2327"><span class="mrow" id="MathJax-Span-2328"><span class="mo" id="MathJax-Span-2329" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="mi" id="MathJax-Span-2330" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-2331" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2332"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2333" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2334" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2335" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2336" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="msubsup" id="MathJax-Span-2337" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2338"><span class="mrow" id="MathJax-Span-2339"><span class="mi" id="MathJax-Span-2340" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-2341"><span class="mrow" id="MathJax-Span-2342"><span class="msubsup" id="MathJax-Span-2343"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2344" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="mi" id="MathJax-Span-2345" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2346" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-2347"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2348" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-2349" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2350" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-2351"></span><span class="msubsup" id="MathJax-Span-2352" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2353" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2354" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2355" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2356"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2357" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2358" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2359"><span class="mrow" id="MathJax-Span-2360"><span class="mo" id="MathJax-Span-2361" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2362"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2363" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2364" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2365" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2366" style="font-family: MathJax_Main;">]</span><span class="texatom" id="MathJax-Span-2367"><span class="mrow" id="MathJax-Span-2368"><span class="mo" id="MathJax-Span-2369" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.689em, 1010.75em, 4.806em, -999.997em); top: -0.256em; left: 0em;"><span class="mtd" id="MathJax-Span-2372"><span class="mrow" id="MathJax-Span-2373"><span class="mi" id="MathJax-Span-2374"></span><span class="mo" id="MathJax-Span-2375" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-2376" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 3.515em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2377"><span class="mrow" id="MathJax-Span-2378"><span class="mi" id="MathJax-Span-2379" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-2380"><span class="mrow" id="MathJax-Span-2381"><span class="msubsup" id="MathJax-Span-2382"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2383" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2384"><span class="mrow" id="MathJax-Span-2385"><span class="mn" id="MathJax-Span-2386" style="font-size: 50%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2387" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2388" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2389" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2390"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2391" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2392"><span class="mrow" id="MathJax-Span-2393"><span class="mn" id="MathJax-Span-2394" style="font-size: 50%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2395" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2396" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2397" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2398" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2399"><span class="mrow" id="MathJax-Span-2400"><span class="mo" id="MathJax-Span-2401" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="mi" id="MathJax-Span-2402" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-2403" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2404"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2405" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2406" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2407" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2408" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="mn" id="MathJax-Span-2409" style="font-family: MathJax_Main; padding-left: 0.209em;">0</span><span class="texatom" id="MathJax-Span-2410"><span class="mrow" id="MathJax-Span-2411"><span class="mo" id="MathJax-Span-2412" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span><span class="mo" id="MathJax-Span-2413" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mn" id="MathJax-Span-2414" style="font-family: MathJax_Main; padding-left: 0.261em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.23em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.309em; border-left: 0px solid; width: 0px; height: 11.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow></mtd><mtd><mi></mi><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>:</mo><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub><mo stretchy="false">[</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>:</mo><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub><mo stretchy="false">[</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mi>E</mi></mrow></munder><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>a</mi><mi>t</mi></msub></mrow></msub><mo stretchy="false">[</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow><mo>=</mo><mn>0</mn></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-73">\begin{align}
\mathbb{E}_{\tau \sim \pi_\theta}\Big[\nabla_\theta \log \pi_\theta(a_t|s_t) b(s_t)\Big] &=  \mathbb{E}_{s_{0:t},a_{0:t-1}}\Big[ \mathbb{E}_{s_{t+1:T},a_{t:T-1}} [\nabla_\theta \log \pi_\theta(a_t|s_t) b(s_t)]\Big] \\
&= \mathbb{E}_{s_{0:t},a_{0:t-1}}\Big[ b(s_t) \cdot \underbrace{\mathbb{E}_{s_{t+1:T},a_{t:T-1}} [\nabla_\theta \log \pi_\theta(a_t|s_t)]}_{E}\Big] \\
&= \mathbb{E}_{s_{0:t},a_{0:t-1}}\Big[ b(s_t) \cdot \mathbb{E}_{a_t} [\nabla_\theta \log \pi_\theta(a_t|s_t)]\Big] \\
&= \mathbb{E}_{s_{0:t},a_{0:t-1}}\Big[ b(s_t) \cdot 0 \Big] = 0
\end{align}</script>

<p>Here are my usual overly-detailed comments (apologies in advance):</p>

<ul>
  <li>
    <p><strong>Note I</strong>: this notation is similar to what I had before. The trajectory
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2415" style="width: 9.713em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.009em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1008.01em, 2.534em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-2416"><span class="msubsup" id="MathJax-Span-2417"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2418" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-2419" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2420" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2421" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2422" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-2423" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2424" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2425" style="font-family: MathJax_Main; padding-left: 0.158em;">…</span><span class="mo" id="MathJax-Span-2426" style="font-family: MathJax_Main; padding-left: 0.158em;">,</span><span class="msubsup" id="MathJax-Span-2427" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2428" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-2429"><span class="mrow" id="MathJax-Span-2430"><span class="mi" id="MathJax-Span-2431" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2432" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2433" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2434" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2435" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2436" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-2437"><span class="mrow" id="MathJax-Span-2438"><span class="mi" id="MathJax-Span-2439" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-74">s_0,a_0,\ldots,a_{T-1},s_{T}</script> is now represented as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2440" style="width: 5.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.6em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1004.6em, 2.534em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-2441"><span class="msubsup" id="MathJax-Span-2442"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2443" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-2444"><span class="mrow" id="MathJax-Span-2445"><span class="mn" id="MathJax-Span-2446" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2447" style="font-size: 70.7%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2448" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2449" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2450" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2451" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-2452"><span class="mrow" id="MathJax-Span-2453"><span class="mn" id="MathJax-Span-2454" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2455" style="font-size: 70.7%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2456" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2457" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2458" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-75">s_{0:T},a_{0:T-1}</script>.
In addition, the expectation is split up, which is allowed. If this is
confusing, think of the definition of the expectation with respect to at least
two variables. We can write brackets in any appropriately enclosed location.
Furthermore, we can “omit” the un-necessary variables in going from
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2459" style="width: 5.323em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.393em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1004.39em, 2.585em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2460"><span class="msubsup" id="MathJax-Span-2461"><span style="display: inline-block; position: relative; width: 4.393em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2462"><span class="mrow" id="MathJax-Span-2463"><span class="mi" id="MathJax-Span-2464" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-2465"><span class="mrow" id="MathJax-Span-2466"><span class="msubsup" id="MathJax-Span-2467"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2468" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2469"><span class="mrow" id="MathJax-Span-2470"><span class="mi" id="MathJax-Span-2471" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2472" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2473" style="font-size: 50%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2474" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2475" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2476" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2477"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2478" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2479"><span class="mrow" id="MathJax-Span-2480"><span class="mi" id="MathJax-Span-2481" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2482" style="font-size: 50%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-2483" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2484" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2485" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>:</mo><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-76">\mathbb{E}_{s_{t+1:T},a_{t:T-1}}</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2486" style="width: 1.655em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1001.35em, 2.534em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2487"><span class="msubsup" id="MathJax-Span-2488"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2489"><span class="mrow" id="MathJax-Span-2490"><span class="mi" id="MathJax-Span-2491" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-2492"><span class="mrow" id="MathJax-Span-2493"><span class="msubsup" id="MathJax-Span-2494"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2495" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="mi" id="MathJax-Span-2496" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>a</mi><mi>t</mi></msub></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-77">\mathbb{E}_{a_t}</script> (see expression
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2497" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.78em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2498"><span class="mi" id="MathJax-Span-2499" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">E</script> above). Concretely, assuming we’re in discrete-land with actions in
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2500" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1000.83em, 2.327em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2501"><span class="texatom" id="MathJax-Span-2502"><span class="mrow" id="MathJax-Span-2503"><span class="mi" id="MathJax-Span-2504" style="font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-79">\mathcal{A}</script> and states in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2505" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1000.67em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2506"><span class="texatom" id="MathJax-Span-2507"><span class="mrow" id="MathJax-Span-2508"><span class="mi" id="MathJax-Span-2509" style="font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-80">\mathcal{S}</script>, this is because <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2510" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.78em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2511"><span class="mi" id="MathJax-Span-2512" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi></math></span></span><script type="math/tex" id="MathJax-Element-81">E</script> evaluates
to:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2513" style="width: 42.874em; display: inline-block;"><span style="display: inline-block; position: relative; width: 35.436em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-2.322em, 1035.18em, 6.098em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2514"><span class="mtable" id="MathJax-Span-2515" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 35.127em; height: 0px;"><span style="position: absolute; clip: rect(3.308em, 1000.78em, 10.127em, -999.997em); top: -7.487em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -7.332em; right: 0em;"><span class="mtd" id="MathJax-Span-2516"><span class="mrow" id="MathJax-Span-2517"><span class="mi" id="MathJax-Span-2518" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -4.13em; right: 0em;"><span class="mtd" id="MathJax-Span-2689"><span class="mrow" id="MathJax-Span-2690"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -1.495em; right: 0em;"><span class="mtd" id="MathJax-Span-2825"><span class="mrow" id="MathJax-Span-2826"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.492em;"></span></span><span style="position: absolute; clip: rect(4.703em, 1034.3em, 13.122em, -999.997em); top: -9.14em; left: 0.777em;"><span style="display: inline-block; position: relative; width: 34.403em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1033.78em, 6.098em, -999.997em); top: -7.332em; left: 0em;"><span class="mtd" id="MathJax-Span-2519"><span class="mrow" id="MathJax-Span-2520"><span class="mi" id="MathJax-Span-2521"></span><span class="mo" id="MathJax-Span-2522" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="munderover" id="MathJax-Span-2523" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0.106em;"><span class="mo" id="MathJax-Span-2524" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.65em, 4.341em, -999.997em); top: -2.838em; left: 0em;"><span class="texatom" id="MathJax-Span-2525"><span class="mrow" id="MathJax-Span-2526"><span class="msubsup" id="MathJax-Span-2527"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2528" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="mi" id="MathJax-Span-2529" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2530" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2531"><span class="mrow" id="MathJax-Span-2532"><span class="mi" id="MathJax-Span-2533" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2534" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0.364em;"><span class="mo" id="MathJax-Span-2535" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1002.12em, 4.393em, -999.997em); top: -2.838em; left: 0em;"><span class="texatom" id="MathJax-Span-2536"><span class="mrow" id="MathJax-Span-2537"><span class="msubsup" id="MathJax-Span-2538"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2539" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2540"><span class="mrow" id="MathJax-Span-2541"><span class="mi" id="MathJax-Span-2542" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2543" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2544" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2545" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2546"><span class="mrow" id="MathJax-Span-2547"><span class="mi" id="MathJax-Span-2548" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2549" style="font-family: MathJax_Main; padding-left: 0.158em;">⋯</span><span class="munderover" id="MathJax-Span-2550" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0.106em;"><span class="mo" id="MathJax-Span-2551" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.65em, 4.341em, -999.997em); top: -2.838em; left: 0em;"><span class="texatom" id="MathJax-Span-2552"><span class="mrow" id="MathJax-Span-2553"><span class="msubsup" id="MathJax-Span-2554"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2555" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="mi" id="MathJax-Span-2556" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2557" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2558"><span class="mrow" id="MathJax-Span-2559"><span class="mi" id="MathJax-Span-2560" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2561" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 18.029em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1018.03em, 5.116em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2562"><span class="mrow" id="MathJax-Span-2563"><span class="munderover" id="MathJax-Span-2564"><span style="display: inline-block; position: relative; width: 18.029em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1017.93em, 4.393em, -999.997em); top: -3.975em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2565"><span class="msubsup" id="MathJax-Span-2566"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2567" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2568" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2569" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2570"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2571" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2573"><span class="mrow" id="MathJax-Span-2574"><span class="mo" id="MathJax-Span-2575" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2576"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2577" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2578" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2579" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-2580" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2581" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2582"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2583" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-2584"><span class="mrow" id="MathJax-Span-2585"><span class="mi" id="MathJax-Span-2586" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2587" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2588" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2589"><span class="mrow" id="MathJax-Span-2590"><span class="mo" id="MathJax-Span-2591" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2592"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2593" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2595" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2596" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2597" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2598" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2599" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2600" style="font-family: MathJax_Main; padding-left: 0.158em;">⋯</span><span class="mi" id="MathJax-Span-2601" style="font-family: MathJax_Math-italic; padding-left: 0.158em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2602" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2603"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2604" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2605" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2606"><span class="mrow" id="MathJax-Span-2607"><span class="mo" id="MathJax-Span-2608" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2609"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2610" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-2611"><span class="mrow" id="MathJax-Span-2612"><span class="mi" id="MathJax-Span-2613" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2614" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2615" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2616" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2617" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2618" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-2619"><span class="mrow" id="MathJax-Span-2620"><span class="mi" id="MathJax-Span-2621" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2622" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2623" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2624" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.81em, 1018.03em, 2.637em, -999.997em); top: -1.495em; left: 0em;"><span class="mo" id="MathJax-Span-2625" style=""><span style="display: inline-block; position: relative; width: 18.029em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.975em; left: 0.003em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.975em; left: 17.565em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.975em; left: 8.577em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 0.416em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 0.777em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 1.139em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 1.552em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 1.914em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 2.275em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 2.637em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 2.998em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 3.36em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 3.773em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 4.135em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 4.496em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 4.858em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 5.22em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 5.633em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 5.994em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 6.356em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 6.717em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 7.079em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 7.441em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 7.854em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 8.215em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 9.403em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 9.817em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 10.178em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 10.54em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 10.901em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 11.263em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 11.624em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 12.038em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 12.399em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 12.761em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 13.122em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 13.484em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 13.846em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 14.259em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 14.62em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 14.982em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 15.343em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 15.705em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 16.067em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 16.48em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 16.841em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.975em; left: 17.203em;"><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.275em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1008.42em, 4.393em, -999.997em); top: -2.322em; left: 4.806em;"><span class="texatom" id="MathJax-Span-2626"><span class="mrow" id="MathJax-Span-2627"><span class="mi" id="MathJax-Span-2628" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-2629" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2630" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2631"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2632" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="mi" id="MathJax-Span-2633" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2634" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2635"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2636" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2637"><span class="mrow" id="MathJax-Span-2638"><span class="mi" id="MathJax-Span-2639" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2640" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2641" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2642" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2643"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2644" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2645"><span class="mrow" id="MathJax-Span-2646"><span class="mi" id="MathJax-Span-2647" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2648" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2649" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2650" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2651" style="font-size: 70.7%; font-family: MathJax_Main;">…</span><span class="mo" id="MathJax-Span-2652" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2653"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2654" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2655"><span class="mrow" id="MathJax-Span-2656"><span class="mi" id="MathJax-Span-2657" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2658" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2659" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2660" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2661"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2662" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2663"><span class="mrow" id="MathJax-Span-2664"><span class="mi" id="MathJax-Span-2665" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2666" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2667" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2668" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2669"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2670" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-2671" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2672" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-2673"></span><span class="msubsup" id="MathJax-Span-2674" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2675" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2676" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2677" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2678"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2679" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2680" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2681"><span class="mrow" id="MathJax-Span-2682"><span class="mo" id="MathJax-Span-2683" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2684"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2685" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2686" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2687" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2688" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.895em, 1034.3em, 5.529em, -999.997em); top: -4.13em; left: 0em;"><span class="mtd" id="MathJax-Span-2691"><span class="mrow" id="MathJax-Span-2692"><span class="mi" id="MathJax-Span-2693"></span><span class="mo" id="MathJax-Span-2694" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="munderover" id="MathJax-Span-2695" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0.106em;"><span class="mo" id="MathJax-Span-2696" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.65em, 4.341em, -999.997em); top: -2.838em; left: 0em;"><span class="texatom" id="MathJax-Span-2697"><span class="mrow" id="MathJax-Span-2698"><span class="msubsup" id="MathJax-Span-2699"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2700" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="mi" id="MathJax-Span-2701" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2702" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2703"><span class="mrow" id="MathJax-Span-2704"><span class="mi" id="MathJax-Span-2705" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2706" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2707" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2708" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2709" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2710"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2711" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2712" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2713"><span class="mrow" id="MathJax-Span-2714"><span class="mo" id="MathJax-Span-2715" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2716"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2717" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2718" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2719" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2720"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2721" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-2722" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2723" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-2724"></span><span class="msubsup" id="MathJax-Span-2725" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2726" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2727" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2728" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2729"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2730" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2731" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2732"><span class="mrow" id="MathJax-Span-2733"><span class="mo" id="MathJax-Span-2734" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2735"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2736" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2737" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2738" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-2739" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0.364em;"><span class="mo" id="MathJax-Span-2740" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1002.12em, 4.393em, -999.997em); top: -2.838em; left: 0em;"><span class="texatom" id="MathJax-Span-2741"><span class="mrow" id="MathJax-Span-2742"><span class="msubsup" id="MathJax-Span-2743"><span style="display: inline-block; position: relative; width: 1.191em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2744" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="texatom" id="MathJax-Span-2745"><span class="mrow" id="MathJax-Span-2746"><span class="mi" id="MathJax-Span-2747" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2748" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2749" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2750" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2751"><span class="mrow" id="MathJax-Span-2752"><span class="mi" id="MathJax-Span-2753" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2754" style="font-family: MathJax_Math-italic; padding-left: 0.158em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2755" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2756"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2757" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-2758"><span class="mrow" id="MathJax-Span-2759"><span class="mi" id="MathJax-Span-2760" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2761" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2762" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2763"><span class="mrow" id="MathJax-Span-2764"><span class="mo" id="MathJax-Span-2765" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2766"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2767" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2768" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2769" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2770" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2771" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2772" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2773" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-2774" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0.416em;"><span class="mo" id="MathJax-Span-2775" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1002.27em, 4.393em, -999.997em); top: -2.838em; left: 0em;"><span class="texatom" id="MathJax-Span-2776"><span class="mrow" id="MathJax-Span-2777"><span class="msubsup" id="MathJax-Span-2778"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2779" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="texatom" id="MathJax-Span-2780"><span class="mrow" id="MathJax-Span-2781"><span class="mi" id="MathJax-Span-2782" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2783" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2784" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2785" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2786"><span class="mrow" id="MathJax-Span-2787"><span class="mi" id="MathJax-Span-2788" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2789" style="font-family: MathJax_Main; padding-left: 0.158em;">⋯</span><span class="munderover" id="MathJax-Span-2790" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0.106em;"><span class="mo" id="MathJax-Span-2791" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.65em, 4.341em, -999.997em); top: -2.838em; left: 0em;"><span class="texatom" id="MathJax-Span-2792"><span class="mrow" id="MathJax-Span-2793"><span class="msubsup" id="MathJax-Span-2794"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2795" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.313em;"><span class="mi" id="MathJax-Span-2796" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2797" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2798"><span class="mrow" id="MathJax-Span-2799"><span class="mi" id="MathJax-Span-2800" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2801" style="font-family: MathJax_Math-italic; padding-left: 0.158em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2802" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2803"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2804" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2805" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2806"><span class="mrow" id="MathJax-Span-2807"><span class="mo" id="MathJax-Span-2808" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2809"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2810" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-2811"><span class="mrow" id="MathJax-Span-2812"><span class="mi" id="MathJax-Span-2813" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2814" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2815" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2816" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2817" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2818" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-2819"><span class="mrow" id="MathJax-Span-2820"><span class="mi" id="MathJax-Span-2821" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2822" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2823" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2824" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.895em, 1013.23em, 5.478em, -999.997em); top: -1.495em; left: 0em;"><span class="mtd" id="MathJax-Span-2827"><span class="mrow" id="MathJax-Span-2828"><span class="mi" id="MathJax-Span-2829"></span><span class="mo" id="MathJax-Span-2830" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="munderover" id="MathJax-Span-2831" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0.106em;"><span class="mo" id="MathJax-Span-2832" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.65em, 4.341em, -999.997em); top: -2.838em; left: 0em;"><span class="texatom" id="MathJax-Span-2833"><span class="mrow" id="MathJax-Span-2834"><span class="msubsup" id="MathJax-Span-2835"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2836" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="mi" id="MathJax-Span-2837" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2838" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2839"><span class="mrow" id="MathJax-Span-2840"><span class="mi" id="MathJax-Span-2841" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2842" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2843" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2844" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2845" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2846"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2847" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2848" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2849"><span class="mrow" id="MathJax-Span-2850"><span class="mo" id="MathJax-Span-2851" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2852"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2853" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2854" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2855" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2856"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2857" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-2858" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2859" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-2860"></span><span class="msubsup" id="MathJax-Span-2861" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2862" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2863" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2864" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2865"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2866" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2867" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2868"><span class="mrow" id="MathJax-Span-2869"><span class="mo" id="MathJax-Span-2870" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2871"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2872" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2873" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2874" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.145em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.684em; border-left: 0px solid; width: 0px; height: 9.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>E</mi></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>a</mi><mi>t</mi></msub><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow></mrow></munder><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow></mrow></munder><mo>⋯</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mi>T</mi></msub><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow></mrow></munder><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>⋯</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>T</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></munder><mo stretchy="false">(</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>a</mi><mi>t</mi></msub><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow></mrow></munder><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow></mrow></munder><mi>P</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow></mrow></munder><mo>⋯</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mi>T</mi></msub><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">S</mi></mrow></mrow></munder><mi>P</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>T</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>a</mi><mi>t</mi></msub><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow></mrow></munder><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-82">\begin{align}
E &= \sum_{a_t\in \mathcal{A}}\sum_{s_{t+1}\in \mathcal{S}}\cdots \sum_{s_T\in \mathcal{S}} \underbrace{\pi_\theta(a_t|s_t)P(s_{t+1}|s_t,a_t) \cdots P(s_T|s_{T-1},a_{T-1})}_{p((a_t,s_{t+1},a_{t+1}, \ldots, a_{T-1},s_{T}))} (\nabla_\theta \log \pi_\theta(a_t|s_t)) \\
&= \sum_{a_t\in \mathcal{A}} \pi_\theta(a_t|s_t)\nabla_\theta \log \pi_\theta(a_t|s_t) \sum_{s_{t+1}\in \mathcal{S}} P(s_{t+1}|s_t,a_t) \sum_{a_{t+1}\in \mathcal{A}}\cdots \sum_{s_T\in \mathcal{S}} P(s_T|s_{T-1},a_{T-1})\\
&= \sum_{a_t\in \mathcal{A}} \pi_\theta(a_t|s_t)\nabla_\theta \log \pi_\theta(a_t|s_t) 
\end{align}</script>

    <p>This is true because of the definition of expectation, whereby we get the
joint density over the entire trajectory, and then we can split it up like we
did earlier with the gradient of the log probability computation. We can
distribute <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2875" style="width: 7.905em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.511em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1006.41em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-2876"><span class="msubsup" id="MathJax-Span-2877"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2878" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-2879" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2880" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-2881"></span><span class="msubsup" id="MathJax-Span-2882" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2883" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2884" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2885" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2886"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2887" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2888" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2889"><span class="mrow" id="MathJax-Span-2890"><span class="mo" id="MathJax-Span-2891" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2892"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2893" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2894" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2895" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-83">\nabla_\theta \log \pi_\theta(a_t|s_t)</script> all the way back to (but
not beyond) the first sum over <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2896" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.88em, 2.43em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2897"><span class="msubsup" id="MathJax-Span-2898"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2899" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2900" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-84">a_t</script>. Pushing sums “further back” results in
a bunch of sums over densities, each of which sums to one. The astute reader
will notice that this is precisely what happens with <a href="https://danieltakeshi.github.io/2015-07-12-notes-on-exact-inference-in-graphical-models/">variable elimination for
graphical models</a>. (The more technical reason why “pushing values back
through sums” is allowed has to do with abstract algebra properties of the sum
function, which is beyond the scope of this post.)</p>
  </li>
  <li>
    <p><strong>Note II</strong>: This proof above also works with an infinite-time horizon. In
Appendix B of the <em>Generalized Advantage Estimation</em> paper (<a href="https://arxiv.org/abs/1506.02438">arXiv link</a>),
the authors do so with a proof exactly matching the above, except that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2901" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.67em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-2902"><span class="mi" id="MathJax-Span-2903" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">T</script>
and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2904" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.379em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1002.33em, 2.43em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-2905"><span class="mi" id="MathJax-Span-2906" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="mn" id="MathJax-Span-2908" style="font-family: MathJax_Main; padding-left: 0.209em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-86">T-1</script> are now infinity.</p>
  </li>
  <li>
    <p><strong>Note III</strong>: About the expectation going to zero, that’s due to a
well-known fact about <em>score</em> functions, which are precisely the gradient of
log probailities. We went over this in <a href="https://danieltakeshi.github.io/2016/12/20/review-of-theoretical-statistics-stat-210a-at-berkeley/">my STAT 210A class last fall</a>. It’s
<em>again</em> the log derivative trick. Observe that:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2909" style="width: 43.701em; display: inline-block;"><span style="display: inline-block; position: relative; width: 36.108em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.604em, 1036.06em, 4.341em, -999.997em); top: -3.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2910"><span class="msubsup" id="MathJax-Span-2911"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-2912"><span class="mrow" id="MathJax-Span-2913"><span class="mi" id="MathJax-Span-2914" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-2915"><span class="mrow" id="MathJax-Span-2916"><span class="msubsup" id="MathJax-Span-2917"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2918" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.364em;"><span class="mi" id="MathJax-Span-2919" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2920" style=""><span class="mrow" id="MathJax-Span-2921"><span class="mo" id="MathJax-Span-2922" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="msubsup" id="MathJax-Span-2923"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2924" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-2925" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-2926" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-2927"></span><span class="msubsup" id="MathJax-Span-2928" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2929" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2930" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2931" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2932"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2933" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2934" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2935"><span class="mrow" id="MathJax-Span-2936"><span class="mo" id="MathJax-Span-2937" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2938"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2939" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2940" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2941" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-2942" style=""><span class="mrow" id="MathJax-Span-2943"><span class="mo" id="MathJax-Span-2944" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span><span class="mo" id="MathJax-Span-2945" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mo" id="MathJax-Span-2946" style="font-family: MathJax_Size2; vertical-align: 0.003em; padding-left: 0.261em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.416em;"></span></span><span class="mfrac" id="MathJax-Span-2947" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 5.065em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.05em, 1004.86em, 4.393em, -999.997em); top: -4.698em; left: 50%; margin-left: -2.477em;"><span class="mrow" id="MathJax-Span-2948"><span class="msubsup" id="MathJax-Span-2949"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2950" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-2951" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2952"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2953" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-2954" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2955" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2956"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2957" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2958" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2959"><span class="mrow" id="MathJax-Span-2960"><span class="mo" id="MathJax-Span-2961" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2962"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2963" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2964" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2965" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.05em, 1003.62em, 4.393em, -999.997em); top: -3.252em; left: 50%; margin-left: -1.857em;"><span class="mrow" id="MathJax-Span-2966"><span class="msubsup" id="MathJax-Span-2967"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2968" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-2969"><span class="mrow" id="MathJax-Span-2970"><span class="mi" id="MathJax-Span-2971" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2972" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2973"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2974" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2975" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2976"><span class="mrow" id="MathJax-Span-2977"><span class="mo" id="MathJax-Span-2978" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2979"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2980" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2981" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2982" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1005.07em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.065em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2983"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2984" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-2985"><span class="mrow" id="MathJax-Span-2986"><span class="mi" id="MathJax-Span-2987" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2988" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2989"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2990" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-2991" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2992"><span class="mrow" id="MathJax-Span-2993"><span class="mo" id="MathJax-Span-2994" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-2995"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-2996" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-2997" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-2998" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-2999" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3000"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3001" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-3002" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3003" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-3004" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3005" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-3006" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3007" style="font-family: MathJax_Size2; vertical-align: 0.003em; padding-left: 0.158em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.416em;"></span></span><span class="msubsup" id="MathJax-Span-3008" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3009" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-3010"><span class="mrow" id="MathJax-Span-3011"><span class="mi" id="MathJax-Span-3012" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3013" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3014"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3015" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-3016" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3017"><span class="mrow" id="MathJax-Span-3018"><span class="mo" id="MathJax-Span-3019" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-3020"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3021" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3022" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3023" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-3024" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3025"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3026" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-3027" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3028" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-3029" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3030" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-3031" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3032" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="mn" id="MathJax-Span-3033" style="font-family: MathJax_Main; padding-left: 0.209em;">1</span><span class="mo" id="MathJax-Span-3034" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mn" id="MathJax-Span-3035" style="font-family: MathJax_Main; padding-left: 0.261em;">0</span></span><span style="display: inline-block; width: 0px; height: 3.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>a</mi><mi>t</mi></msub></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow><mo>=</mo><mo>∫</mo><mfrac><mrow><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mrow><msub><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><msub><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi>d</mi><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mo>∫</mo><msub><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi>d</mi><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mo>⋅</mo><mn>1</mn><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-87">\mathbb{E}_{a_t}\Big[\nabla_\theta \log \pi_\theta(a_t|s_t)\Big] 
= \int \frac{\nabla_\theta
\pi_\theta(a_t|s_t)}{\pi_{\theta}(a_t|s_t)}\pi_{\theta}(a_t|s_t)da_t
= \nabla_\theta \int \pi_{\theta}(a_t|s_t)da_t = \nabla_\theta \cdot 1 = 0</script>

    <p>where the penultimate step follows from how <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3036" style="width: 1.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1000.98em, 2.43em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-3037"><span class="msubsup" id="MathJax-Span-3038"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3039" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-3040" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-88">\pi_\theta</script> is a density. This
follows for all time steps, and since the gradient of the log gets distributed
for each <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3041" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1000.31em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-3042"><span class="mi" id="MathJax-Span-3043" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-89">t</script>, it applies in all time steps. I switched to the
continuous-land version for this, but it also applies with sums, as I just
recently used in Note I.</p>
  </li>
</ul>

<p>The above shows that introducing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3044" style="width: 0.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.42em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-3045"><span class="mi" id="MathJax-Span-3046" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-90">b</script> doesn’t cause bias.</p>

<p>The last thing to cover is why its introduction reduces variance. I provide an
approximate argument. To simplify notation, set <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3047" style="width: 8.939em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.389em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.036em, 1007.39em, 2.637em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-3048"><span class="msubsup" id="MathJax-Span-3049"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3050" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.777em;"><span class="mi" id="MathJax-Span-3051" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3052" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3053" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3054" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3055" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="munderover" id="MathJax-Span-3056" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1000.98em, 4.393em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3057" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.5em, 4.186em, -999.997em); top: -4.44em; left: 1.036em;"><span class="texatom" id="MathJax-Span-3058"><span class="mrow" id="MathJax-Span-3059"><span class="mi" id="MathJax-Span-3060" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3061" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3062" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.35em, 4.135em, -999.997em); top: -3.665em; left: 1.036em;"><span class="texatom" id="MathJax-Span-3063"><span class="mrow" id="MathJax-Span-3064"><span class="msup" id="MathJax-Span-3065"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3066" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-3067" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3068" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-3069" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3070" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3071" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-3072"><span class="mrow" id="MathJax-Span-3073"><span class="msup" id="MathJax-Span-3074"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3075" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-3076" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-91">R_t(\tau) =
\sum_{t'=t}^{T-1}r_{t'}</script>. We focus on the <em>inside</em> of the expectation (of the
gradient estimate) to analyze the variance. The technical reason for this is
that expectations are technically <em>constant</em> (and thus have variance zero) but
in practice we have to approximate the expectations with trajectories, and that
has high variance.</p>

<p>The variance is approximated as:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;V&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mover&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3077" style="width: 50.106em; display: inline-block;"><span style="display: inline-block; position: relative; width: 41.377em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-1.392em, 1041.02em, 5.116em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-3078"><span class="mtable" id="MathJax-Span-3079" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 41.067em; height: 0px;"><span style="position: absolute; clip: rect(2.534em, 1018.13em, 7.854em, -999.997em); top: -6.041em; left: 0em;"><span style="display: inline-block; position: relative; width: 18.133em; height: 0px;"><span style="position: absolute; clip: rect(2.069em, 1018.13em, 5.374em, -999.997em); top: -5.576em; right: 0em;"><span class="mtd" id="MathJax-Span-3080"><span class="mrow" id="MathJax-Span-3081"><span class="texatom" id="MathJax-Span-3082"><span class="mrow" id="MathJax-Span-3083"><span class="mi" id="MathJax-Span-3084" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-3085" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-3086" style="font-family: MathJax_Main;">r</span></span></span><span class="mrow" id="MathJax-Span-3087" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3088" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-3089"><span class="munderover" id="MathJax-Span-3090"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3091" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-3092"><span class="mrow" id="MathJax-Span-3093"><span class="mi" id="MathJax-Span-3094" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3095" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-3096" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3097"><span class="mrow" id="MathJax-Span-3098"><span class="mi" id="MathJax-Span-3099" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3100" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3101" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3102" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3103" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-3104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-3105" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-3106"></span><span class="msubsup" id="MathJax-Span-3107" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3108" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-3109" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3110" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3111"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3112" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-3113" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3114"><span class="mrow" id="MathJax-Span-3115"><span class="mo" id="MathJax-Span-3116" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-3117"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3118" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3119" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3120" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3121" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3122"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3123" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.777em;"><span class="mi" id="MathJax-Span-3124" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3125" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3126" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3127" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3128" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="mi" id="MathJax-Span-3129" style="font-family: MathJax_Math-italic; padding-left: 0.209em;">b</span><span class="mo" id="MathJax-Span-3130" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3131"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3132" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3133" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3134" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3135" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-3136" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span class="mspace" id="MathJax-Span-3137" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000.26em, 4.135em, -999.997em); top: -2.322em; right: 0em;"><span class="mtd" id="MathJax-Span-3210"><span class="mrow" id="MathJax-Span-3211"><span class="mspace" id="MathJax-Span-3212" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.046em;"></span></span><span style="position: absolute; clip: rect(3.722em, 1022.68em, 10.23em, -999.997em); top: -7.229em; left: 18.133em;"><span style="display: inline-block; position: relative; width: 22.936em; height: 0px;"><span style="position: absolute; clip: rect(2.12em, 1019.84em, 5.323em, -999.997em); top: -5.576em; left: 0em;"><span class="mtd" id="MathJax-Span-3138"><span class="mrow" id="MathJax-Span-3139"><span class="mi" id="MathJax-Span-3140"></span><span class="mover" id="MathJax-Span-3141" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.73em, 4.083em, -999.997em); top: -3.975em; left: 0.003em;"><span class="mo" id="MathJax-Span-3142" style="font-family: MathJax_Main;">≈</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em, 1000.73em, 4.29em, -999.997em); top: -4.749em; left: 0em;"><span class="mrow" id="MathJax-Span-3143"><span class="mo" id="MathJax-Span-3144" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3145" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3146" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mspace" id="MathJax-Span-3147" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="munderover" id="MathJax-Span-3148" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3149" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-3150"><span class="mrow" id="MathJax-Span-3151"><span class="mi" id="MathJax-Span-3152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3153" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-3154" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3155"><span class="mrow" id="MathJax-Span-3156"><span class="mi" id="MathJax-Span-3157" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3158" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3159" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3160" style="padding-left: 0.158em;"><span class="mrow" id="MathJax-Span-3161"><span class="mi" id="MathJax-Span-3162" style="font-family: MathJax_AMS;">E</span></span></span><span class="mi" id="MathJax-Span-3163" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mrow" id="MathJax-Span-3164" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3165" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mrow" id="MathJax-Span-3166"><span class="texatom" id="MathJax-Span-3167"><span class="mrow" id="MathJax-Span-3168"><span class="mo" id="MathJax-Span-3169" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span><span class="msubsup" id="MathJax-Span-3170"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3171" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-3172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-3173" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-3174"></span><span class="msubsup" id="MathJax-Span-3175" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3176" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-3177" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3178" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3179"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3180" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-3181" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3182"><span class="mrow" id="MathJax-Span-3183"><span class="mo" id="MathJax-Span-3184" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-3185"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3186" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3187" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3188" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3189" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3190"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3191" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.777em;"><span class="mi" id="MathJax-Span-3192" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3193" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3194" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3195" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3196" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="mi" id="MathJax-Span-3197" style="font-family: MathJax_Math-italic; padding-left: 0.209em;">b</span><span class="mo" id="MathJax-Span-3198" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3199"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3200" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3201" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3202" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3203" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3204" style=""><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(2.689em, 1000.42em, 4.806em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3205" style=""><span class="mrow" id="MathJax-Span-3206"><span class="mo" id="MathJax-Span-3207" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.853em; left: 0.622em;"><span class="mn" id="MathJax-Span-3208" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3209" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.12em, 1022.68em, 5.323em, -999.997em); top: -2.322em; left: 0em;"><span class="mtd" id="MathJax-Span-3213"><span class="mrow" id="MathJax-Span-3214"><span class="mi" id="MathJax-Span-3215"></span><span class="texatom" id="MathJax-Span-3216"><span class="mrow" id="MathJax-Span-3217"><span class="mover" id="MathJax-Span-3218"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.73em, 4.083em, -999.997em); top: -3.975em; left: 0.158em;"><span class="mo" id="MathJax-Span-3219" style="font-family: MathJax_Main;">≈</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em, 1000.98em, 4.29em, -999.997em); top: -4.749em; left: 0em;"><span class="mrow" id="MathJax-Span-3220"><span class="mo" id="MathJax-Span-3221" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-3223" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3224" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-3225" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="munderover" id="MathJax-Span-3226" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3227" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-3228"><span class="mrow" id="MathJax-Span-3229"><span class="mi" id="MathJax-Span-3230" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3231" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-3232" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3233"><span class="mrow" id="MathJax-Span-3234"><span class="mi" id="MathJax-Span-3235" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3236" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3237" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3238" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3239"><span class="mrow" id="MathJax-Span-3240"><span class="mi" id="MathJax-Span-3241" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="mi" id="MathJax-Span-3242" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3243" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3244" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mrow" id="MathJax-Span-3245"><span class="texatom" id="MathJax-Span-3246"><span class="mrow" id="MathJax-Span-3247"><span class="mo" id="MathJax-Span-3248" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span><span class="msubsup" id="MathJax-Span-3249"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3250" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-3251" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-3252" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-3253"></span><span class="msubsup" id="MathJax-Span-3254" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3255" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-3256" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3257" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3258"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3259" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-3260" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3261"><span class="mrow" id="MathJax-Span-3262"><span class="mo" id="MathJax-Span-3263" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-3264"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3265" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3266" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3267" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3268" style=""><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(2.689em, 1000.42em, 4.806em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3269" style=""><span class="mrow" id="MathJax-Span-3270"><span class="mo" id="MathJax-Span-3271" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.853em; left: 0.622em;"><span class="mn" id="MathJax-Span-3272" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3273" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span class="msubsup" id="MathJax-Span-3274" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3275"><span class="mrow" id="MathJax-Span-3276"><span class="mi" id="MathJax-Span-3277" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="mi" id="MathJax-Span-3278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3279" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3280" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span><span class="mrow" id="MathJax-Span-3281"><span class="texatom" id="MathJax-Span-3282"><span class="mrow" id="MathJax-Span-3283"><span class="mo" id="MathJax-Span-3284" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span><span class="msubsup" id="MathJax-Span-3285"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3286" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.777em;"><span class="mi" id="MathJax-Span-3287" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3288" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3289" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3290" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3291" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="mi" id="MathJax-Span-3292" style="font-family: MathJax_Math-italic; padding-left: 0.209em;">b</span><span class="mo" id="MathJax-Span-3293" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3294"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3295" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3296" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3297" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3298"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1000.31em, 4.393em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3299" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.416em;"><span class="mn" id="MathJax-Span-3300" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3301" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.234em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.497em; border-left: 0px solid; width: 0px; height: 7.691em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">V</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mspace width="thickmathspace"></mspace></mtd><mtd><mi></mi><mover><mo>≈</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mover><mspace width="thickmathspace"></mspace><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mi>τ</mi><mrow><mo>[</mo><mrow><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">(</mo></mrow><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msup><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">)</mo></mrow><mn>2</mn></msup></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mspace width="thickmathspace"></mspace></mtd><mtd><mi></mi><mrow class="MJX-TeXAtom-ORD"><mover><mo>≈</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>i</mi><mo stretchy="false">)</mo></mrow></mover></mrow><mspace width="thickmathspace"></mspace><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mi>τ</mi></msub><mrow><mo>[</mo><mrow><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">(</mo></mrow><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><msup><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">)</mo></mrow><mn>2</mn></msup></mrow><mo>]</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mi>τ</mi></msub><mrow><mo>[</mo><mrow><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">(</mo></mrow><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-92">\begin{align}
{\rm Var}\left(\sum_{t=0}^{T-1}\nabla_\theta \log \pi_\theta(a_t|s_t) (R_t(\tau)-b(s_t))\right)\;&\overset{(i)}{\approx}\; \sum_{t=0}^{T-1} \mathbb{E}\tau\left[\Big(\nabla_\theta \log \pi_\theta(a_t|s_t) (R_t(\tau)-b(s_t))\Big)^2\right] \\
\;&{\overset{(ii)}{\approx}}\; \sum_{t=0}^{T-1} \mathbb{E}_\tau \left[\Big(\nabla_\theta \log \pi_\theta(a_t|s_t)\Big)^2\right]\mathbb{E}_\tau\left[\Big(R_t(\tau) - b(s_t))^2\right]
\end{align}</script>

<p><strong>Approximation (i)</strong> is because we are approximating the variance of a sum by
computing the sum of the variances. This is not true in general, but if we can
assume this, then by the definition of the variance <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;V&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3302" style="width: 14.414em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.883em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.449em, 1011.88em, 2.843em, -999.997em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-3303"><span class="texatom" id="MathJax-Span-3304"><span class="mrow" id="MathJax-Span-3305"><span class="mi" id="MathJax-Span-3306" style="font-family: MathJax_Main;">V</span><span class="mi" id="MathJax-Span-3307" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-3308" style="font-family: MathJax_Main;">r</span></span></span><span class="mo" id="MathJax-Span-3309" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3310" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3311" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3312" style="font-family: MathJax_Main; padding-left: 0.261em;">:<span style="font-family: MathJax_Main;">=</span></span><span class="texatom" id="MathJax-Span-3313" style="padding-left: 0.261em;"><span class="mrow" id="MathJax-Span-3314"><span class="mi" id="MathJax-Span-3315" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-3316" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-3317"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.83em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3318" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.932em;"><span class="mn" id="MathJax-Span-3319" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3320" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-3321" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="mo" id="MathJax-Span-3322" style="font-family: MathJax_Main; padding-left: 0.209em;">(</span><span class="texatom" id="MathJax-Span-3323"><span class="mrow" id="MathJax-Span-3324"><span class="mi" id="MathJax-Span-3325" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-3326" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3327" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3328" style="font-family: MathJax_Main;">]</span><span class="msubsup" id="MathJax-Span-3329"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1000.31em, 4.393em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3330" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.416em;"><span class="mn" id="MathJax-Span-3331" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.43em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">V</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>:=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mo stretchy="false">[</mo><msup><mi>X</mi><mn>2</mn></msup><mo stretchy="false">]</mo><mo>−</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-93">{\rm Var}(X) :=
\mathbb{E}[X^2]-(\mathbb{E}[X])^2</script>, we are left with the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3332" style="width: 3.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.585em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.449em, 1002.48em, 2.843em, -999.997em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-3333"><span class="texatom" id="MathJax-Span-3334"><span class="mrow" id="MathJax-Span-3335"><span class="mi" id="MathJax-Span-3336" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-3337" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-3338"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.83em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3339" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.932em;"><span class="mn" id="MathJax-Span-3340" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3341" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.43em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mo stretchy="false">[</mo><msup><mi>X</mi><mn>2</mn></msup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-94">\mathbb{E}[X^2]</script>
term since we already showed that introducing the baseline doesn’t cause bias.
<strong>Approximation (ii)</strong> is because we assume independence among the values
involved in the expectation, and thus we can factor the expectation.</p>

<p>Finally, we are left with the term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3342" style="width: 11.16em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.197em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.914em, 1008.99em, 4.032em, -999.997em); top: -3.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3343"><span class="msubsup" id="MathJax-Span-3344"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3345"><span class="mrow" id="MathJax-Span-3346"><span class="mi" id="MathJax-Span-3347" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-3348"><span class="mrow" id="MathJax-Span-3349"><span class="mi" id="MathJax-Span-3350" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3351" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3352" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span><span class="mrow" id="MathJax-Span-3353"><span class="texatom" id="MathJax-Span-3354"><span class="mrow" id="MathJax-Span-3355"><span class="mo" id="MathJax-Span-3356" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span><span class="msubsup" id="MathJax-Span-3357"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3358" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.777em;"><span class="mi" id="MathJax-Span-3359" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3360" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3361" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3362" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3363" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="mi" id="MathJax-Span-3364" style="font-family: MathJax_Math-italic; padding-left: 0.209em;">b</span><span class="mo" id="MathJax-Span-3365" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3366"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3367" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3368" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3369" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3370"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1000.31em, 4.393em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3371" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.416em;"><span class="mn" id="MathJax-Span-3372" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3373" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi></mrow></msub><mrow><mo>[</mo><mrow><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">(</mo></mrow><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mo>]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-95">\mathbb{E}_{\tau} \left[\Big(R_t(\tau) -
b(s_t))^2\right]</script>. If we are able to optimize our choice of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3374" style="width: 2.379em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.86em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-3375"><span class="mi" id="MathJax-Span-3376" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-3377" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3378"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3379" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3380" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3381" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-96">b(s_t)</script>, then
this is a least squares problem, and it is well known that the optimal choice of
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3382" style="width: 2.379em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.86em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-3383"><span class="mi" id="MathJax-Span-3384" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-3385" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3386"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3387" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3388" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3389" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-97">b(s_t)</script> is to be the expected value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3390" style="width: 2.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.43em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1002.33em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-3391"><span class="msubsup" id="MathJax-Span-3392"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3393" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.777em;"><span class="mi" id="MathJax-Span-3394" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3395" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3396" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3397" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-98">R_t(\tau)</script>. In fact, that’s <em>why</em>
policy gradient researchers usually want <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3398" style="width: 8.37em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.924em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1006.82em, 2.843em, -999.997em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-3399"><span class="mi" id="MathJax-Span-3400" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-3401" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3402"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3403" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3404" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3405" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3406" style="font-family: MathJax_Main; padding-left: 0.261em;">≈</span><span class="texatom" id="MathJax-Span-3407" style="padding-left: 0.261em;"><span class="mrow" id="MathJax-Span-3408"><span class="mi" id="MathJax-Span-3409" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-3410" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-3411"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3412" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.777em;"><span class="mi" id="MathJax-Span-3413" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3414" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3415" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3416" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3417" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.43em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>≈</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mo stretchy="false">[</mo><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-99">b(s_t) \approx
\mathbb{E}[R_t(\tau)]</script> to approximate the expected return starting at time
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3418" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1000.31em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-3419"><span class="mi" id="MathJax-Span-3420" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-100">t</script>, and that’s <em>why</em> in the vanilla policy gradient algorithm we have to
re-fit the baseline estimate each time to make it as close to the expected
return <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3421" style="width: 4.393em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.618em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1003.51em, 2.843em, -999.997em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-3422"><span class="texatom" id="MathJax-Span-3423"><span class="mrow" id="MathJax-Span-3424"><span class="mi" id="MathJax-Span-3425" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-3426" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-3427"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3428" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.777em;"><span class="mi" id="MathJax-Span-3429" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3430" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3431" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3432" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3433" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.43em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mo stretchy="false">[</mo><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-101">\mathbb{E}[R_t(\tau)]</script>. At last, I understand.</p>

<p>How accurate are these approximations in practice? My intuition is that they are
actually fine, because recent advances in reinforcement learning algorithms,
such as A3C, focus on the problem of breaking correlation among samples. If the
correlation among samples is broken, then Approximation (i) becomes better,
because I think the samples <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3434" style="width: 9.713em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.009em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1008.01em, 2.534em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-3435"><span class="msubsup" id="MathJax-Span-3436"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3437" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-3438" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3439" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-3440" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3441" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-3442" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3443" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-3444" style="font-family: MathJax_Main; padding-left: 0.158em;">…</span><span class="mo" id="MathJax-Span-3445" style="font-family: MathJax_Main; padding-left: 0.158em;">,</span><span class="msubsup" id="MathJax-Span-3446" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3447" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-3448"><span class="mrow" id="MathJax-Span-3449"><span class="mi" id="MathJax-Span-3450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3451" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3452" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3453" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-3454" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3455" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-3456"><span class="mrow" id="MathJax-Span-3457"><span class="mi" id="MathJax-Span-3458" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>0</mn></msub><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-102">s_0,a_0,\ldots,a_{T-1},s_{T}</script> are <em>no longer
generated from the same trajectory</em>.</p>

<p>Well, that’s my intuition. If anyone else has a better way of describing it,
feel free to let me know in the comments or by email.</p>

<h1 id="discount-factors">Discount Factors</h1>

<p>So far, we have assumed we wanted to optimize the expected return, or the
expected <em>sum of rewards</em>. However, if you’ve studied value iteration and policy
iteration, you’ll remember that we usually use <em>discount factors</em> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3459" style="width: 4.651em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.825em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1003.72em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-3460"><span class="mi" id="MathJax-Span-3461" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3462" style="font-family: MathJax_Main; padding-left: 0.261em;">∈</span><span class="mo" id="MathJax-Span-3463" style="font-family: MathJax_Main; padding-left: 0.261em;">(</span><span class="mn" id="MathJax-Span-3464" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-3465" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-3466" style="font-family: MathJax_Main; padding-left: 0.158em;">1</span><span class="mo" id="MathJax-Span-3467" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo>∈</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-103">\gamma \in
(0,1]</script>. These empirically work well because the effect of an action many time
steps later is likely to be negligible compared to other action. Thus, it may
not make sense to try and include raw distant rewards in our optimization
problem. Thus, we often impose a discount as follows:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3468" style="width: 35.127em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.032em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-1.444em, 1028.62em, 5.168em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-3469"><span class="mtable" id="MathJax-Span-3470" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 28.722em; height: 0px;"><span style="position: absolute; clip: rect(2.482em, 1006.1em, 6.872em, -999.997em); top: -5.059em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.201em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1006.1em, 4.393em, -999.997em); top: -5.628em; right: 0em;"><span class="mtd" id="MathJax-Span-3471"><span class="mrow" id="MathJax-Span-3472"><span class="msubsup" id="MathJax-Span-3473"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3474" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-3475" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3476"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3477"><span class="mrow" id="MathJax-Span-3478"><span class="mi" id="MathJax-Span-3479" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-3480"><span class="mrow" id="MathJax-Span-3481"><span class="mi" id="MathJax-Span-3482" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-3483" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-3484"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3485" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-3486" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3487" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3488" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-3489" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3490" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3491" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3492" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -2.322em; right: 0em;"><span class="mtd" id="MathJax-Span-3575"><span class="mrow" id="MathJax-Span-3576"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.065em;"></span></span><span style="position: absolute; clip: rect(3.773em, 1022.26em, 10.385em, -999.997em); top: -7.332em; left: 6.201em;"><span style="display: inline-block; position: relative; width: 22.523em; height: 0px;"><span style="position: absolute; clip: rect(2.12em, 1020.35em, 5.426em, -999.997em); top: -5.679em; left: 0em;"><span class="mtd" id="MathJax-Span-3493"><span class="mrow" id="MathJax-Span-3494"><span class="mi" id="MathJax-Span-3495"></span><span class="mo" id="MathJax-Span-3496" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-3497" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3498"><span class="mrow" id="MathJax-Span-3499"><span class="mi" id="MathJax-Span-3500" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-3501"><span class="mrow" id="MathJax-Span-3502"><span class="mi" id="MathJax-Span-3503" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-3504" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-3505"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3506" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-3507" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3508" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3509" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-3510"><span class="munderover" id="MathJax-Span-3511"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3512" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-3513"><span class="mrow" id="MathJax-Span-3514"><span class="mi" id="MathJax-Span-3515" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3516" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-3517" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3518"><span class="mrow" id="MathJax-Span-3519"><span class="mi" id="MathJax-Span-3520" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3521" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3522" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3523" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3524" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-3525" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-3526" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-3527"></span><span class="msubsup" id="MathJax-Span-3528" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3529" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-3530" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3531" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3532"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3533" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-3534" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3535"><span class="mrow" id="MathJax-Span-3536"><span class="mo" id="MathJax-Span-3537" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-3538"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3539" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3540" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3541" style="font-family: MathJax_Main;">)</span><span class="mrow" id="MathJax-Span-3542" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3543" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-3544"><span class="munderover" id="MathJax-Span-3545"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3546" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.24em, 4.238em, -999.997em); top: -2.838em; left: 0.106em;"><span class="texatom" id="MathJax-Span-3547"><span class="mrow" id="MathJax-Span-3548"><span class="msup" id="MathJax-Span-3549"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3550" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-3551" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3552" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-3553" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3554"><span class="mrow" id="MathJax-Span-3555"><span class="mi" id="MathJax-Span-3556" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3557" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3558" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3559" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3560" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-3561"><span class="mrow" id="MathJax-Span-3562"><span class="msup" id="MathJax-Span-3563"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3564" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-3565" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3566" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="mi" id="MathJax-Span-3567" style="font-family: MathJax_Math-italic; padding-left: 0.209em;">b</span><span class="mo" id="MathJax-Span-3568" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3569"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3570" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3571" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3572" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-3573" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span><span class="mo" id="MathJax-Span-3574" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.032em;"></span></span><span style="position: absolute; clip: rect(2.12em, 1022.26em, 5.426em, -999.997em); top: -2.373em; left: 0em;"><span class="mtd" id="MathJax-Span-3577"><span class="mrow" id="MathJax-Span-3578"><span class="mi" id="MathJax-Span-3579"></span><span class="mo" id="MathJax-Span-3580" style="font-family: MathJax_Main; padding-left: 0.261em;">≈</span><span class="msubsup" id="MathJax-Span-3581" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3582"><span class="mrow" id="MathJax-Span-3583"><span class="mi" id="MathJax-Span-3584" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-3585"><span class="mrow" id="MathJax-Span-3586"><span class="mi" id="MathJax-Span-3587" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-3588" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-3589"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3590" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-3591" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3592" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3593" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-3594"><span class="munderover" id="MathJax-Span-3595"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3596" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-3597"><span class="mrow" id="MathJax-Span-3598"><span class="mi" id="MathJax-Span-3599" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3600" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-3601" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3602"><span class="mrow" id="MathJax-Span-3603"><span class="mi" id="MathJax-Span-3604" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3605" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3606" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3607" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3608" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-3609" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-3610" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-3611"></span><span class="msubsup" id="MathJax-Span-3612" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3613" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-3614" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3615" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3616"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3617" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-3618" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3619"><span class="mrow" id="MathJax-Span-3620"><span class="mo" id="MathJax-Span-3621" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-3622"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3623" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3624" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3625" style="font-family: MathJax_Main;">)</span><span class="mrow" id="MathJax-Span-3626" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3627" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-3628"><span class="munderover" id="MathJax-Span-3629"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3630" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.24em, 4.238em, -999.997em); top: -2.838em; left: 0.106em;"><span class="texatom" id="MathJax-Span-3631"><span class="mrow" id="MathJax-Span-3632"><span class="msup" id="MathJax-Span-3633"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3634" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-3635" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3636" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-3637" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3638"><span class="mrow" id="MathJax-Span-3639"><span class="mi" id="MathJax-Span-3640" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3641" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3642" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3643" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3644" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.622em;"><span class="texatom" id="MathJax-Span-3645"><span class="mrow" id="MathJax-Span-3646"><span class="msup" id="MathJax-Span-3647"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3648" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-3649" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3650" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-3651" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3652"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3653" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-3654"><span class="mrow" id="MathJax-Span-3655"><span class="msup" id="MathJax-Span-3656"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3657" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-3658" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3659" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="mi" id="MathJax-Span-3660" style="font-family: MathJax_Math-italic; padding-left: 0.209em;">b</span><span class="mo" id="MathJax-Span-3661" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3662"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3663" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3664" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3665" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-3666" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span><span class="mo" id="MathJax-Span-3667" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.337em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.559em; border-left: 0px solid; width: 0px; height: 7.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mo>−</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>≈</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msup><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>−</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mo>−</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-104">\begin{align}
\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R(\tau)] &= \mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta(a_t|s_t) \left(\sum_{t'=t}^{T-1}r_{t'} - b(s_t)\right) \right] \\
&\approx \mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta(a_t|s_t) \left(\sum_{t'=t}^{T-1}\gamma^{t'-t}r_{t'} - b(s_t)\right) \right]
\end{align}</script>

<p>where the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3668" style="width: 2.327em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em, 1001.91em, 2.482em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-3669"><span class="msubsup" id="MathJax-Span-3670"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3671" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.622em;"><span class="texatom" id="MathJax-Span-3672"><span class="mrow" id="MathJax-Span-3673"><span class="msup" id="MathJax-Span-3674"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3675" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-3676" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3677" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-3678" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>−</mo><mi>t</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-105">\gamma^{t'-t}</script> serves as the discount, starting from 1, then
getting smaller as time passes. (The first line above is a repeat of the policy
gradient formula that I describe earlier.) As this is not exactly the “desired”
gradient, this is an <em>approximation</em>, but it’s a reasonable one. This time, we
now want our baseline to satisfy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3679" style="width: 20.715em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.1em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.449em, 1017em, 2.843em, -999.997em); top: -2.425em; left: 0em;"><span class="mrow" id="MathJax-Span-3680"><span class="mi" id="MathJax-Span-3681" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-3682" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3683"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3684" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3685" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3686" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3687" style="font-family: MathJax_Main; padding-left: 0.261em;">≈</span><span class="texatom" id="MathJax-Span-3688" style="padding-left: 0.261em;"><span class="mrow" id="MathJax-Span-3689"><span class="mi" id="MathJax-Span-3690" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-3691" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-3692"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3693" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3694" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3695" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="mi" id="MathJax-Span-3696" style="font-family: MathJax_Math-italic; padding-left: 0.209em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3697"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3698" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-3699"><span class="mrow" id="MathJax-Span-3700"><span class="mi" id="MathJax-Span-3701" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3702" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3703" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3704" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="mo" id="MathJax-Span-3705" style="font-family: MathJax_Main; padding-left: 0.209em;">⋯</span><span class="mo" id="MathJax-Span-3706" style="font-family: MathJax_Main; padding-left: 0.209em;">+</span><span class="msubsup" id="MathJax-Span-3707" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.57em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3708" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.622em;"><span class="texatom" id="MathJax-Span-3709"><span class="mrow" id="MathJax-Span-3710"><span class="mi" id="MathJax-Span-3711" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3712" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3713" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3714" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-3715" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3716"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3717" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-3718"><span class="mrow" id="MathJax-Span-3719"><span class="mi" id="MathJax-Span-3720" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3721" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3722" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3723" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.43em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>≈</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mo stretchy="false">[</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>γ</mi><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msup><mi>γ</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-106">b(s_t) \approx \mathbb{E}[r_t + \gamma
r_{t+1} + \cdots + \gamma^{T-1-t} r_{T-1}]</script>.</p>

<h1 id="advantage-functions">Advantage Functions</h1>

<p>In this final section, we replace the policy gradient formula with the following
<em>value</em> functions:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3724" style="width: 21.18em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.513em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(2.74em, 1017.25em, 6.046em, -999.997em); top: -4.646em; left: 0em;"><span class="mrow" id="MathJax-Span-3725"><span class="msubsup" id="MathJax-Span-3726"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.73em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3727" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.777em;"><span class="mi" id="MathJax-Span-3728" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3729" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3730" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3731" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3732" style="font-family: MathJax_Math-italic; padding-left: 0.158em;">a</span><span class="mo" id="MathJax-Span-3733" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3734" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-3735" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3736"><span class="mrow" id="MathJax-Span-3737"><span class="mi" id="MathJax-Span-3738" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-3739"><span class="mrow" id="MathJax-Span-3740"><span class="mi" id="MathJax-Span-3741" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-3742" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-3743"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3744" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-3745" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3746" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3747" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-3748"><span class="munderover" id="MathJax-Span-3749"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3750" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-3751"><span class="mrow" id="MathJax-Span-3752"><span class="mi" id="MathJax-Span-3753" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3754" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-3755" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3756"><span class="mrow" id="MathJax-Span-3757"><span class="mi" id="MathJax-Span-3758" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3759" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3760" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3761" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3762" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3763" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mspace" id="MathJax-Span-3764" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-3765" style=""><span class="mrow" id="MathJax-Span-3766"><span class="mo" id="MathJax-Span-3767" style="vertical-align: 1.501em;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.2em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.754em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.477em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-3768" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-3769"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3770" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-3771" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3772" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mi" id="MathJax-Span-3773" style="font-family: MathJax_Math-italic; padding-left: 0.261em;">s</span><span class="mo" id="MathJax-Span-3774" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-3775" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3776" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-3777" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3778" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mi" id="MathJax-Span-3779" style="font-family: MathJax_Math-italic; padding-left: 0.261em;">a</span></span><span class="mo" id="MathJax-Span-3780" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.651em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>Q</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mi>t</mi></msub><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.470em" minsize="2.470em">|</mo></mrow><mspace width="thickmathspace"></mspace><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-107">Q^\pi(s,a) = \mathbb{E}_{\tau \sim \pi_\theta}\left[\sum_{t=0}^{T-1} r_t \;\Bigg|\; s_0=s,a_0=a\right]</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3781" style="width: 16.222em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.381em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(2.74em, 1013.12em, 6.046em, -999.997em); top: -4.646em; left: 0em;"><span class="mrow" id="MathJax-Span-3782"><span class="msubsup" id="MathJax-Span-3783"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3784" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.209em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.881em;"><span class="mi" id="MathJax-Span-3785" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3786" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3787" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3788" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3789" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-3790" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3791"><span class="mrow" id="MathJax-Span-3792"><span class="mi" id="MathJax-Span-3793" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-3794"><span class="mrow" id="MathJax-Span-3795"><span class="mi" id="MathJax-Span-3796" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-3797" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-3798"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3799" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-3800" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3801" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3802" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-3803"><span class="munderover" id="MathJax-Span-3804"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3805" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-3806"><span class="mrow" id="MathJax-Span-3807"><span class="mi" id="MathJax-Span-3808" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3809" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-3810" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3811"><span class="mrow" id="MathJax-Span-3812"><span class="mi" id="MathJax-Span-3813" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3814" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3815" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3816" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3817" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3818" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mspace" id="MathJax-Span-3819" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-3820" style=""><span class="mrow" id="MathJax-Span-3821"><span class="mo" id="MathJax-Span-3822" style="vertical-align: 1.501em;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.2em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.754em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.477em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-3823" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-3824"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3825" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-3826" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3827" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mi" id="MathJax-Span-3828" style="font-family: MathJax_Math-italic; padding-left: 0.261em;">s</span></span><span class="mo" id="MathJax-Span-3829" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.651em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mi>t</mi></msub><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.470em" minsize="2.470em">|</mo></mrow><mspace width="thickmathspace"></mspace><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-108">V^\pi(s) = \mathbb{E}_{\tau \sim \pi_\theta}\left[\sum_{t=0}^{T-1} r_t \;\Bigg|\; s_0=s\right]</script>

<p>Both of these should be familiar from basic AI; see the CS 188 notes from
Berkeley if this is unclear. There are also <em>discounted</em> versions, which we can
denote as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3830" style="width: 4.961em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.083em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1003.98em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-3831"><span class="msubsup" id="MathJax-Span-3832"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.73em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3833" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.777em;"><span class="texatom" id="MathJax-Span-3834"><span class="mrow" id="MathJax-Span-3835"><span class="mi" id="MathJax-Span-3836" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3837" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3838" style="font-size: 70.7%; font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3839" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3840" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3841" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3842" style="font-family: MathJax_Math-italic; padding-left: 0.158em;">a</span><span class="mo" id="MathJax-Span-3843" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo>,</mo><mi>γ</mi></mrow></msup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-109">Q^{\pi,\gamma}(s,a)</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3844" style="width: 3.825em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.153em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1003.05em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-3845"><span class="msubsup" id="MathJax-Span-3846"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3847" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.209em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.881em;"><span class="texatom" id="MathJax-Span-3848"><span class="mrow" id="MathJax-Span-3849"><span class="mi" id="MathJax-Span-3850" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3851" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3852" style="font-size: 70.7%; font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3853" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3854" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3855" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo>,</mo><mi>γ</mi></mrow></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-110">V^{\pi,\gamma}(s)</script>. In addition, we can
also consider starting at any given time step, as in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3856" style="width: 5.788em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.755em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1004.65em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-3857"><span class="msubsup" id="MathJax-Span-3858"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.73em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3859" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.777em;"><span class="texatom" id="MathJax-Span-3860"><span class="mrow" id="MathJax-Span-3861"><span class="mi" id="MathJax-Span-3862" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3863" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3864" style="font-size: 70.7%; font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3865" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3866"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3867" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3868" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3869" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-3870" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3871" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-3872" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3873" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo>,</mo><mi>γ</mi></mrow></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-111">Q^{\pi,\gamma}(s_t,a_t)</script>
which provides the expected (discounted) return assuming that at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3874" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em, 1000.31em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-3875"><span class="mi" id="MathJax-Span-3876" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-112">t</script>, our
state-action pair is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3877" style="width: 3.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1002.79em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-3878"><span class="mo" id="MathJax-Span-3879" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3880"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3881" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3882" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3883" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-3884" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3885" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-3886" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3887" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-113">(s_t,a_t)</script>.</p>

<p>What might be new is the <em>advantage</em> function. For the undiscounted version, it
is defined simply as:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3888" style="width: 14.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.038em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1011.93em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-3889"><span class="msubsup" id="MathJax-Span-3890"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.73em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3891" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.777em;"><span class="mi" id="MathJax-Span-3892" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3893" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3894" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3895" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3896" style="font-family: MathJax_Math-italic; padding-left: 0.158em;">a</span><span class="mo" id="MathJax-Span-3897" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3898" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-3899" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.73em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3900" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.777em;"><span class="mi" id="MathJax-Span-3901" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3902" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3903" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3904" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3905" style="font-family: MathJax_Math-italic; padding-left: 0.158em;">a</span><span class="mo" id="MathJax-Span-3906" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3907" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="msubsup" id="MathJax-Span-3908" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3909" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.209em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.881em;"><span class="mi" id="MathJax-Span-3910" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3911" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3912" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3913" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>A</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>Q</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>−</mo><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-114">A^\pi(s,a) = Q^\pi(s,a) - V^\pi(s)</script>

<p>with a similar definition for the discounted version. Intuitively, the advantage
tells us how much better action <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3914" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1000.52em, 2.275em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-3915"><span class="mi" id="MathJax-Span-3916" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-115">a</script> would be compared to the return based on
an “average” action.</p>

<p>The above definitions look very close to what we have in our policy gradient
formula. In fact, we can claim the following:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3917" style="width: 35.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.548em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(-4.749em, 1029.13em, 8.474em, -999.997em); top: -2.115em; left: 0em;"><span class="mrow" id="MathJax-Span-3918"><span class="mtable" id="MathJax-Span-3919" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 29.238em; height: 0px;"><span style="position: absolute; clip: rect(5.839em, 1006.1em, 16.79em, -999.997em); top: -11.671em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.201em; height: 0px;"><span style="position: absolute; clip: rect(3.05em, 1006.1em, 4.393em, -999.997em); top: -8.933em; right: 0em;"><span class="mtd" id="MathJax-Span-3920"><span class="mrow" id="MathJax-Span-3921"><span class="msubsup" id="MathJax-Span-3922"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3923" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-3924" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3925"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3926"><span class="mrow" id="MathJax-Span-3927"><span class="mi" id="MathJax-Span-3928" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-3929"><span class="mrow" id="MathJax-Span-3930"><span class="mi" id="MathJax-Span-3931" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-3932" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-3933"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3934" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-3935" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3936" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3937" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-3938" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3939" style="font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3940" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3941" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -5.628em; right: 0em;"><span class="mtd" id="MathJax-Span-4024"><span class="mrow" id="MathJax-Span-4025"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: -2.322em; right: 0em;"><span class="mtd" id="MathJax-Span-4114"><span class="mrow" id="MathJax-Span-4115"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.825em, 1000em, 4.135em, -999.997em); top: 0.984em; right: 0em;"><span class="mtd" id="MathJax-Span-4190"><span class="mrow" id="MathJax-Span-4191"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.676em;"></span></span><span style="position: absolute; clip: rect(7.027em, 1022.78em, 20.251em, -999.997em); top: -13.892em; left: 6.201em;"><span style="display: inline-block; position: relative; width: 23.04em; height: 0px;"><span style="position: absolute; clip: rect(2.12em, 1020.35em, 5.426em, -999.997em); top: -8.985em; left: 0em;"><span class="mtd" id="MathJax-Span-3942"><span class="mrow" id="MathJax-Span-3943"><span class="mi" id="MathJax-Span-3944"></span><span class="mo" id="MathJax-Span-3945" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-3946" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-3947"><span class="mrow" id="MathJax-Span-3948"><span class="mi" id="MathJax-Span-3949" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-3950"><span class="mrow" id="MathJax-Span-3951"><span class="mi" id="MathJax-Span-3952" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-3953" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-3954"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3955" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-3956" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3957" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3958" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-3959"><span class="munderover" id="MathJax-Span-3960"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3961" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-3962"><span class="mrow" id="MathJax-Span-3963"><span class="mi" id="MathJax-Span-3964" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3965" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-3966" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3967"><span class="mrow" id="MathJax-Span-3968"><span class="mi" id="MathJax-Span-3969" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-3970" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3971" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3972" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3973" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-3974" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-3975" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-3976"></span><span class="msubsup" id="MathJax-Span-3977" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3978" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-3979" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3980" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3981"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3982" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-3983" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3984"><span class="mrow" id="MathJax-Span-3985"><span class="mo" id="MathJax-Span-3986" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-3987"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3988" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-3989" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-3990" style="font-family: MathJax_Main;">)</span><span class="mrow" id="MathJax-Span-3991" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-3992" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-3993"><span class="munderover" id="MathJax-Span-3994"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-3995" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.308em, 1001.24em, 4.238em, -999.997em); top: -2.838em; left: 0.106em;"><span class="texatom" id="MathJax-Span-3996"><span class="mrow" id="MathJax-Span-3997"><span class="msup" id="MathJax-Span-3998"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-3999" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-4000" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4001" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-4002" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4003"><span class="mrow" id="MathJax-Span-4004"><span class="mi" id="MathJax-Span-4005" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-4006" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4007" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4008" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4009" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.768em; left: 0.467em;"><span class="texatom" id="MathJax-Span-4010"><span class="mrow" id="MathJax-Span-4011"><span class="msup" id="MathJax-Span-4012"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4013" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.261em;"><span class="mo" id="MathJax-Span-4014" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4015" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="mi" id="MathJax-Span-4016" style="font-family: MathJax_Math-italic; padding-left: 0.209em;">b</span><span class="mo" id="MathJax-Span-4017" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4018"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4019" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-4020" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4021" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-4022" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span><span class="mo" id="MathJax-Span-4023" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.032em;"></span></span><span style="position: absolute; clip: rect(2.069em, 1022.78em, 5.374em, -999.997em); top: -5.628em; left: 0em;"><span class="mtd" id="MathJax-Span-4026"><span class="mrow" id="MathJax-Span-4027"><span class="mi" id="MathJax-Span-4028"></span><span class="texatom" id="MathJax-Span-4029"><span class="mrow" id="MathJax-Span-4030"><span class="mover" id="MathJax-Span-4031"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.463em, 1000.73em, 3.98em, -999.997em); top: -3.975em; left: 0.003em;"><span class="mo" id="MathJax-Span-4032" style="font-family: MathJax_Main;">=</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em, 1000.73em, 4.29em, -999.997em); top: -4.646em; left: 0em;"><span class="mrow" id="MathJax-Span-4033"><span class="mo" id="MathJax-Span-4034" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4035" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4036" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-4037" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-4038"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-4039"><span class="mrow" id="MathJax-Span-4040"><span class="mi" id="MathJax-Span-4041" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-4042"><span class="mrow" id="MathJax-Span-4043"><span class="mi" id="MathJax-Span-4044" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-4045" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-4046"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4047" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-4048" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-4049" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-4050" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-4051"><span class="munderover" id="MathJax-Span-4052"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-4053" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-4054"><span class="mrow" id="MathJax-Span-4055"><span class="mi" id="MathJax-Span-4056" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4057" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-4058" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4059"><span class="mrow" id="MathJax-Span-4060"><span class="mi" id="MathJax-Span-4061" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-4062" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4063" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4064" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4065" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-4066" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-4067" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-4068"></span><span class="msubsup" id="MathJax-Span-4069" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4070" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-4071" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4072" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4073"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4074" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-4075" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-4076"><span class="mrow" id="MathJax-Span-4077"><span class="mo" id="MathJax-Span-4078" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-4079"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4080" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-4081" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4082" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4083" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="texatom" id="MathJax-Span-4084" style="padding-left: 0.209em;"><span class="mrow" id="MathJax-Span-4085"><span class="mo" id="MathJax-Span-4086" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span><span class="msubsup" id="MathJax-Span-4087"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.73em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4088" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.777em;"><span class="texatom" id="MathJax-Span-4089"><span class="mrow" id="MathJax-Span-4090"><span class="mi" id="MathJax-Span-4091" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4092" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4093"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4094" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-4095" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4096" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4097" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4098" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-4099" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4100" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4101" style="font-family: MathJax_Main; padding-left: 0.209em;">−</span><span class="msubsup" id="MathJax-Span-4102" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4103" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.209em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.881em;"><span class="mi" id="MathJax-Span-4104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4105" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4106"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4107" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-4108" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4109" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-4110" style=""><span class="mrow" id="MathJax-Span-4111"><span class="mo" id="MathJax-Span-4112" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span></span><span class="mo" id="MathJax-Span-4113" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.069em, 1017.67em, 5.374em, -999.997em); top: -2.322em; left: 0em;"><span class="mtd" id="MathJax-Span-4116"><span class="mrow" id="MathJax-Span-4117"><span class="mi" id="MathJax-Span-4118"></span><span class="texatom" id="MathJax-Span-4119"><span class="mrow" id="MathJax-Span-4120"><span class="mover" id="MathJax-Span-4121"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.463em, 1000.73em, 3.98em, -999.997em); top: -3.975em; left: 0.158em;"><span class="mo" id="MathJax-Span-4122" style="font-family: MathJax_Main;">=</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em, 1000.98em, 4.29em, -999.997em); top: -4.646em; left: 0em;"><span class="mrow" id="MathJax-Span-4123"><span class="mo" id="MathJax-Span-4124" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4125" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4127" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-4128" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-4129"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-4130"><span class="mrow" id="MathJax-Span-4131"><span class="mi" id="MathJax-Span-4132" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-4133"><span class="mrow" id="MathJax-Span-4134"><span class="mi" id="MathJax-Span-4135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-4136" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-4137"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-4139" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-4140" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-4141" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-4142"><span class="munderover" id="MathJax-Span-4143"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-4144" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-4145"><span class="mrow" id="MathJax-Span-4146"><span class="mi" id="MathJax-Span-4147" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4148" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-4149" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4150"><span class="mrow" id="MathJax-Span-4151"><span class="mi" id="MathJax-Span-4152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-4153" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4154" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4155" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4156" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-4157" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-4158" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-4159"></span><span class="msubsup" id="MathJax-Span-4160" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4161" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-4162" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4163" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4164"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4165" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-4166" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-4167"><span class="mrow" id="MathJax-Span-4168"><span class="mo" id="MathJax-Span-4169" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-4170"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4171" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-4172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4173" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4174" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="msubsup" id="MathJax-Span-4175" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.73em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4176" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.777em;"><span class="texatom" id="MathJax-Span-4177"><span class="mrow" id="MathJax-Span-4178"><span class="mi" id="MathJax-Span-4179" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4180" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4181"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4182" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-4183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4184" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4185" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4186" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-4187" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4188" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-4189" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.069em, 1018.49em, 5.374em, -999.997em); top: 0.984em; left: 0em;"><span class="mtd" id="MathJax-Span-4192"><span class="mrow" id="MathJax-Span-4193"><span class="mi" id="MathJax-Span-4194"></span><span class="texatom" id="MathJax-Span-4195"><span class="mrow" id="MathJax-Span-4196"><span class="mover" id="MathJax-Span-4197"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.73em, 4.083em, -999.997em); top: -3.975em; left: 0.261em;"><span class="mo" id="MathJax-Span-4198" style="font-family: MathJax_Main;">≈</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em, 1001.24em, 4.29em, -999.997em); top: -4.749em; left: 0em;"><span class="mrow" id="MathJax-Span-4199"><span class="mo" id="MathJax-Span-4200" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4201" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4202" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4204" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-4205" style="height: 0em; vertical-align: 0em; width: 0.261em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-4206"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.62em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-4207"><span class="mrow" id="MathJax-Span-4208"><span class="mi" id="MathJax-Span-4209" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="texatom" id="MathJax-Span-4210"><span class="mrow" id="MathJax-Span-4211"><span class="mi" id="MathJax-Span-4212" style="font-size: 70.7%; font-family: MathJax_Math-italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-4213" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-4214"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-4216" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mrow" id="MathJax-Span-4217" style="padding-left: 0.158em;"><span class="mo" id="MathJax-Span-4218" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-4219"><span class="munderover" id="MathJax-Span-4220"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(2.895em, 1001.4em, 4.6em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-4221" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1001.14em, 4.238em, -999.997em); top: -2.89em; left: 0.158em;"><span class="texatom" id="MathJax-Span-4222"><span class="mrow" id="MathJax-Span-4223"><span class="mi" id="MathJax-Span-4224" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4225" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-4226" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.257em, 1001.35em, 4.186em, -999.997em); top: -5.111em; left: 0.003em;"><span class="texatom" id="MathJax-Span-4227"><span class="mrow" id="MathJax-Span-4228"><span class="mi" id="MathJax-Span-4229" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-4230" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4231" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4232" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.78em, 4.186em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4233" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.829em;"><span class="mi" id="MathJax-Span-4234" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-4235" style="font-family: MathJax_Main; padding-left: 0.158em;">log</span><span class="mo" id="MathJax-Span-4236"></span><span class="msubsup" id="MathJax-Span-4237" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4238" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-4239" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4240" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4241"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4242" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-4243" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-4244"><span class="mrow" id="MathJax-Span-4245"><span class="mo" id="MathJax-Span-4246" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-4247"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4248" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-4249" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4250" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4251" style="font-family: MathJax_Main; padding-left: 0.209em;">⋅</span><span class="msubsup" id="MathJax-Span-4252" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.73em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4253" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.777em;"><span class="texatom" id="MathJax-Span-4254"><span class="mrow" id="MathJax-Span-4255"><span class="mi" id="MathJax-Span-4256" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4257" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4258" style="font-size: 70.7%; font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4259" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4260"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4261" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-4262" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4263" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4264" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4265" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-4266" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4267" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-4268" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 13.897em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.12em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -7.559em; border-left: 0px solid; width: 0px; height: 15.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd><mtd><mi></mi><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mo>−</mo><mi>b</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mrow class="MJX-TeXAtom-ORD"><mover><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mover></mrow><mspace width="thickmathspace"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">(</mo></mrow><msup><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mi>π</mi></mrow></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">)</mo></mrow></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mrow class="MJX-TeXAtom-ORD"><mover><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>i</mi><mo stretchy="false">)</mo></mrow></mover></mrow><mspace width="thickmathspace"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>π</mi></mrow></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mrow class="MJX-TeXAtom-ORD"><mover><mo>≈</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>i</mi><mi>i</mi><mo stretchy="false">)</mo></mrow></mover></mrow><mspace width="thickmathspace"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo>,</mo><mi>γ</mi></mrow></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-116">\begin{align}
\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R(\tau)] &= \mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta(a_t|s_t) \left(\sum_{t'=t}^{T-1}r_{t'} - b(s_t)\right) \right] \\
&{\overset{(i)}{=}}\; \mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta(a_t|s_t) \cdot \Big(Q^{\pi}(s_t,a_t)-V^\pi(s_t)\Big) \right] \\
&{\overset{(ii)}{=}}\; \mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta(a_t|s_t) \cdot A^{\pi}(s_t,a_t) \right] \\
&{\overset{(iii)}{\approx}}\; \mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta(a_t|s_t) \cdot A^{\pi,\gamma}(s_t,a_t) \right]
\end{align}</script>

<p>In (i), we replace terms with their expectations. This is <em>not</em> generally valid
to do, but it should work in this case. My guess is that if you start from the
second line above (after the “(i)”) and plug in the definition of the
expectation inside and rearrange terms, you can get the first line. However, I
have not had the time to check this in detail and it takes a lot of space to
write out the expectation fully. The conditioning with the value functions makes
it a bit messy and thus the law of iterated expectation may be needed.</p>

<p>Also from line (i), we notice that <em>the value function is a baseline</em>, and hence
we can add it there without changing the unbiased-ness of the expectation.  Then
lines (ii) and (iii) are just for the advantage function. The implication of
this formula is that the problem of policy gradients, in some sense, <em>reduces to
finding good estimates <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4269" style="width: 5.684em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.703em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em, 1004.6em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-4270"><span class="msubsup" id="MathJax-Span-4271"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px;"><span style="position: absolute; clip: rect(2.792em, 1000.73em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-4272"><span class="mrow" id="MathJax-Span-4273"><span class="munderover" id="MathJax-Span-4274"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.73em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4275" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000.36em, 3.618em, -999.997em); top: -4.285em; left: 0.261em;"><span class="mo" id="MathJax-Span-4276" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.698em; left: 0.777em;"><span class="texatom" id="MathJax-Span-4277"><span class="mrow" id="MathJax-Span-4278"><span class="mi" id="MathJax-Span-4279" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4280" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4281" style="font-size: 70.7%; font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4282" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4283"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4284" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-4285" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4286" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4287" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4288" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-4289" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4290" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>A</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo>,</mo><mi>γ</mi></mrow></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-117">\hat{A}^{\pi,\gamma}(s_t,a_t)</script> of the advantage
function</em> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4291" style="width: 5.684em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.703em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1004.6em, 2.585em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-4292"><span class="msubsup" id="MathJax-Span-4293"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px;"><span style="position: absolute; clip: rect(3.102em, 1000.73em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4294" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.777em;"><span class="texatom" id="MathJax-Span-4295"><span class="mrow" id="MathJax-Span-4296"><span class="mi" id="MathJax-Span-4297" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4298" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4299" style="font-size: 70.7%; font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4300" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4301"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4302" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-4303" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4304" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4305" style="padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-4306" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mi" id="MathJax-Span-4307" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4308" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo>,</mo><mi>γ</mi></mrow></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-118">A^{\pi,\gamma}(s_t,a_t)</script>. That is precisely the topic of the paper
<em><a href="https://arxiv.org/abs/1506.02438">Generalized Advantage Estimation</a></em>.</p>

<h1 id="concluding-remarks">Concluding Remarks</h1>

<p>Hopefully, this is a helpful, self-contained, bare-minimum introduction to
policy gradients.  I am trying to learn more about these algorithms, and going
through the math details is helpful. This will also make it easier for me to
understand the increasing number of research papers that are using this
notation.</p>

<p>I also have to mention: I remember a few years ago during the <a href="https://danieltakeshi.github.io/2015-12-17-review-of-deep-reinforcement-learning-cs-294-112-at-berkeley/">first iteration
of CS 294-112</a> that I had no idea how policy gradients worked. Now, I think I
have become slightly more enlightened.</p>

<p><strong>Acknowledgements</strong>: I thank John Schulman for making his notes publicly
available.</p>

<p><strong>Update April 19, 2017</strong>: I have code for vanilla policy gradients in my
<a href="https://github.com/DanielTakeshi/rl_algorithms">reinforcement learning GitHub repository</a>.</p>


  </article>


  <div id="disqus_recommendations" style="margin-bottom: 12px;"><iframe id="dsq-app8078" name="dsq-app8078" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Going Deeper Into Reinforcement Learning_ Fundamentals of Policy Gradients_files/saved_resource.html" style="width: 100% !important; border: none !important; overflow: hidden !important; height: 269px !important; display: inline !important; box-sizing: border-box !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div><div id="disqus_thread"><iframe id="dsq-app3799" name="dsq-app3799" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Going Deeper Into Reinforcement Learning_ Fundamentals of Policy Gradients_files/saved_resource(1).html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 2703px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
  <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'seitasplace';
              
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


  <script src="./Going Deeper Into Reinforcement Learning_ Fundamentals of Policy Gradients_files/MathJax(1).js" id="">
  </script>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Seita's Place</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Seita's Place</li>
          <li><a href="mailto:seita@cs.berkeley.edu">seita@cs.berkeley.edu</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/DanielTakeshi">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"></path>
                </svg>
              </span>

              <span class="username">DanielTakeshi</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/(Never!)">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></path>
                </svg>
              </span>

              <span class="username">(Never!)</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">This is my blog, where I have written over 300 articles on a variety of topics. Recent posts tend to focus on computer science, my area of specialty as a Ph.D. student at UC Berkeley.
</p>
      </div>
    </div>

  </div>

</footer>

    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-98893273-1', 'auto');
  ga('send', 'pageview');
</script>

    
  


<iframe style="display: none;" src="./Going Deeper Into Reinforcement Learning_ Fundamentals of Policy Gradients_files/saved_resource(2).html"></iframe><iframe style="display: none;" src="./Going Deeper Into Reinforcement Learning_ Fundamentals of Policy Gradients_files/saved_resource(3).html"></iframe><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size3, sans-serif;"></div></div></body></html>